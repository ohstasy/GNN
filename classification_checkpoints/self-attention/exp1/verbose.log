Command line
python /Users/anastasiakuznecova/PycharmProjects/chemprop-master/Testing Chemprop for project.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'self_attention',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'tests/data/Halicin_train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'classification_checkpoints/self-attention/exp1/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Could not write the reproducibility section of the arguments to file, thus omitting this section.
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 3.7933e-01, PNorm = 34.0189, GNorm = 0.1784, lr_0 = 2.5000e-04
Loss = 1.9208e-01, PNorm = 34.0302, GNorm = 1.1688, lr_0 = 3.8636e-04
Loss = 2.7771e-01, PNorm = 34.0317, GNorm = 1.0459, lr_0 = 5.2273e-04
Validation auc = 0.535726
Validation accuracy = 0.928571
Epoch 1
Loss = 2.0231e-01, PNorm = 34.0528, GNorm = 0.3899, lr_0 = 6.7273e-04
Loss = 2.2259e-01, PNorm = 34.0634, GNorm = 0.6683, lr_0 = 8.0909e-04
Loss = 2.1777e-01, PNorm = 34.0884, GNorm = 0.4180, lr_0 = 9.4545e-04
Validation auc = 0.765812
Validation accuracy = 0.928571
Epoch 2
Loss = 3.2184e-01, PNorm = 34.1104, GNorm = 0.9818, lr_0 = 9.8516e-04
Loss = 2.1661e-01, PNorm = 34.1365, GNorm = 0.1605, lr_0 = 9.6091e-04
Loss = 1.8636e-01, PNorm = 34.1579, GNorm = 0.5727, lr_0 = 9.3726e-04
Loss = 1.6888e-01, PNorm = 34.1847, GNorm = 0.1042, lr_0 = 9.1420e-04
Loss = 1.6091e-01, PNorm = 34.1895, GNorm = 0.2039, lr_0 = 9.1192e-04
Validation auc = 0.644444
Validation accuracy = 0.928571
Epoch 3
Loss = 2.0563e-01, PNorm = 34.2193, GNorm = 0.1571, lr_0 = 8.8948e-04
Loss = 2.1593e-01, PNorm = 34.2499, GNorm = 0.1513, lr_0 = 8.6758e-04
Loss = 1.5875e-01, PNorm = 34.2726, GNorm = 0.3750, lr_0 = 8.4623e-04
Validation auc = 0.860513
Validation accuracy = 0.928571
Epoch 4
Loss = 2.0736e-01, PNorm = 34.2978, GNorm = 0.3487, lr_0 = 8.2540e-04
Loss = 1.8048e-01, PNorm = 34.3349, GNorm = 0.2279, lr_0 = 8.0509e-04
Loss = 1.6102e-01, PNorm = 34.3610, GNorm = 0.2472, lr_0 = 7.8527e-04
Validation auc = 0.875214
Validation accuracy = 0.928571
Epoch 5
Loss = 1.4961e-01, PNorm = 34.3913, GNorm = 0.2936, lr_0 = 7.6595e-04
Loss = 1.7541e-01, PNorm = 34.4343, GNorm = 0.3698, lr_0 = 7.4710e-04
Loss = 1.8499e-01, PNorm = 34.4795, GNorm = 0.2755, lr_0 = 7.2871e-04
Loss = 1.8718e-01, PNorm = 34.5066, GNorm = 0.3809, lr_0 = 7.1077e-04
Validation auc = 0.882735
Validation accuracy = 0.928571
Epoch 6
Loss = 1.7513e-01, PNorm = 34.5558, GNorm = 0.3670, lr_0 = 6.9156e-04
Loss = 1.5230e-01, PNorm = 34.6107, GNorm = 0.2741, lr_0 = 6.7453e-04
Loss = 1.9365e-01, PNorm = 34.6533, GNorm = 0.6247, lr_0 = 6.5793e-04
Validation auc = 0.903590
Validation accuracy = 0.928571
Epoch 7
Loss = 1.7361e-01, PNorm = 34.7042, GNorm = 0.5565, lr_0 = 6.4174e-04
Loss = 1.4858e-01, PNorm = 34.7398, GNorm = 0.1758, lr_0 = 6.2595e-04
Loss = 1.8243e-01, PNorm = 34.7860, GNorm = 0.3452, lr_0 = 6.1054e-04
Validation auc = 0.912137
Validation accuracy = 0.928571
Epoch 8
Loss = 1.5987e-01, PNorm = 34.8491, GNorm = 0.3067, lr_0 = 5.9403e-04
Loss = 1.3036e-01, PNorm = 34.9178, GNorm = 0.3305, lr_0 = 5.7941e-04
Loss = 1.5645e-01, PNorm = 34.9765, GNorm = 0.8023, lr_0 = 5.6515e-04
Loss = 1.6082e-01, PNorm = 35.0243, GNorm = 0.3378, lr_0 = 5.5124e-04
Validation auc = 0.914530
Validation accuracy = 0.938095
Epoch 9
Loss = 1.3480e-01, PNorm = 35.0794, GNorm = 0.4250, lr_0 = 5.3767e-04
Loss = 1.8233e-01, PNorm = 35.1299, GNorm = 0.4545, lr_0 = 5.2444e-04
Loss = 1.3154e-01, PNorm = 35.2028, GNorm = 0.3925, lr_0 = 5.1153e-04
Validation auc = 0.916923
Validation accuracy = 0.947619
Epoch 10
Loss = 1.0867e-01, PNorm = 35.2507, GNorm = 0.2456, lr_0 = 4.9894e-04
Loss = 1.6930e-01, PNorm = 35.2895, GNorm = 0.2324, lr_0 = 4.8666e-04
Loss = 1.4872e-01, PNorm = 35.3519, GNorm = 0.5390, lr_0 = 4.7469e-04
Validation auc = 0.929231
Validation accuracy = 0.957143
Epoch 11
Loss = 2.8727e-01, PNorm = 35.4109, GNorm = 0.7845, lr_0 = 4.6185e-04
Loss = 1.1604e-01, PNorm = 35.4850, GNorm = 0.4370, lr_0 = 4.5048e-04
Loss = 1.2141e-01, PNorm = 35.5280, GNorm = 0.7147, lr_0 = 4.3940e-04
Loss = 1.5656e-01, PNorm = 35.5541, GNorm = 0.7334, lr_0 = 4.2858e-04
Validation auc = 0.911111
Validation accuracy = 0.957143
Epoch 12
Loss = 1.2932e-01, PNorm = 35.6059, GNorm = 0.3266, lr_0 = 4.1803e-04
Loss = 1.3795e-01, PNorm = 35.6497, GNorm = 0.8475, lr_0 = 4.0775e-04
Loss = 1.1406e-01, PNorm = 35.6928, GNorm = 0.1979, lr_0 = 3.9771e-04
Validation auc = 0.892650
Validation accuracy = 0.961905
Epoch 13
Loss = 9.0574e-02, PNorm = 35.7343, GNorm = 0.3677, lr_0 = 3.8696e-04
Loss = 1.5575e-01, PNorm = 35.7640, GNorm = 0.6752, lr_0 = 3.7743e-04
Loss = 1.0729e-01, PNorm = 35.8145, GNorm = 0.1771, lr_0 = 3.6814e-04
Loss = 1.4142e-01, PNorm = 35.8480, GNorm = 0.3797, lr_0 = 3.5908e-04
Validation auc = 0.912821
Validation accuracy = 0.957143
Epoch 14
Loss = 1.2932e-01, PNorm = 35.8924, GNorm = 0.3520, lr_0 = 3.5025e-04
Loss = 1.5838e-01, PNorm = 35.9267, GNorm = 0.3787, lr_0 = 3.4163e-04
Loss = 7.3960e-02, PNorm = 35.9483, GNorm = 0.2387, lr_0 = 3.3322e-04
Validation auc = 0.893675
Validation accuracy = 0.952381
Epoch 15
Loss = 1.0971e-01, PNorm = 35.9773, GNorm = 1.4603, lr_0 = 3.2502e-04
Loss = 1.4556e-01, PNorm = 36.0166, GNorm = 0.3931, lr_0 = 3.1702e-04
Loss = 1.0003e-01, PNorm = 36.0451, GNorm = 0.8789, lr_0 = 3.0921e-04
Validation auc = 0.888205
Validation accuracy = 0.957143
Epoch 16
Loss = 1.0721e-01, PNorm = 36.0787, GNorm = 0.8887, lr_0 = 3.0085e-04
Loss = 1.2199e-01, PNorm = 36.1029, GNorm = 0.8055, lr_0 = 2.9345e-04
Loss = 8.7769e-02, PNorm = 36.1399, GNorm = 1.6117, lr_0 = 2.8623e-04
Loss = 1.4218e-01, PNorm = 36.1563, GNorm = 0.7585, lr_0 = 2.7918e-04
Validation auc = 0.907009
Validation accuracy = 0.957143
Epoch 17
Loss = 9.0998e-02, PNorm = 36.1816, GNorm = 0.1835, lr_0 = 2.7231e-04
Loss = 1.2212e-01, PNorm = 36.2060, GNorm = 0.9877, lr_0 = 2.6561e-04
Loss = 1.1625e-01, PNorm = 36.2320, GNorm = 0.6973, lr_0 = 2.5907e-04
Validation auc = 0.907350
Validation accuracy = 0.957143
Epoch 18
Loss = 1.1267e-01, PNorm = 36.2518, GNorm = 0.2934, lr_0 = 2.5207e-04
Loss = 1.1774e-01, PNorm = 36.2735, GNorm = 0.3399, lr_0 = 2.4586e-04
Loss = 1.1522e-01, PNorm = 36.2975, GNorm = 0.6070, lr_0 = 2.3981e-04
Validation auc = 0.897094
Validation accuracy = 0.957143
Epoch 19
Loss = 5.8612e-02, PNorm = 36.3213, GNorm = 0.5799, lr_0 = 2.3391e-04
Loss = 1.2017e-01, PNorm = 36.3462, GNorm = 0.5106, lr_0 = 2.2815e-04
Loss = 9.4486e-02, PNorm = 36.3682, GNorm = 0.3056, lr_0 = 2.2254e-04
Loss = 9.9531e-02, PNorm = 36.3790, GNorm = 0.4375, lr_0 = 2.1706e-04
Validation auc = 0.901880
Validation accuracy = 0.947619
Epoch 20
Loss = 8.8439e-02, PNorm = 36.4040, GNorm = 0.6968, lr_0 = 2.1172e-04
Loss = 1.1740e-01, PNorm = 36.4245, GNorm = 1.0121, lr_0 = 2.0651e-04
Loss = 9.2634e-02, PNorm = 36.4423, GNorm = 2.0079, lr_0 = 2.0142e-04
Validation auc = 0.884103
Validation accuracy = 0.961905
Epoch 21
Loss = 1.2350e-01, PNorm = 36.4552, GNorm = 1.1079, lr_0 = 1.9598e-04
Loss = 1.1278e-01, PNorm = 36.4807, GNorm = 0.5835, lr_0 = 1.9115e-04
Loss = 8.9143e-02, PNorm = 36.4954, GNorm = 0.3638, lr_0 = 1.8645e-04
Validation auc = 0.896068
Validation accuracy = 0.966667
Epoch 22
Loss = 2.7922e-02, PNorm = 36.5117, GNorm = 0.3265, lr_0 = 1.8186e-04
Loss = 7.3948e-02, PNorm = 36.5267, GNorm = 0.3516, lr_0 = 1.7739e-04
Loss = 7.6696e-02, PNorm = 36.5399, GNorm = 0.2646, lr_0 = 1.7302e-04
Loss = 1.1770e-01, PNorm = 36.5559, GNorm = 0.7252, lr_0 = 1.6876e-04
Validation auc = 0.893675
Validation accuracy = 0.952381
Epoch 23
Loss = 5.5323e-02, PNorm = 36.5754, GNorm = 0.2457, lr_0 = 1.6420e-04
Loss = 1.0595e-01, PNorm = 36.5842, GNorm = 0.3553, lr_0 = 1.6016e-04
Loss = 1.0146e-01, PNorm = 36.5970, GNorm = 0.5118, lr_0 = 1.5622e-04
Validation auc = 0.891624
Validation accuracy = 0.966667
Epoch 24
Loss = 6.9067e-02, PNorm = 36.6079, GNorm = 0.6789, lr_0 = 1.5237e-04
Loss = 9.9300e-02, PNorm = 36.6222, GNorm = 0.8933, lr_0 = 1.4862e-04
Loss = 7.9610e-02, PNorm = 36.6324, GNorm = 0.4530, lr_0 = 1.4496e-04
Loss = 1.0084e-01, PNorm = 36.6457, GNorm = 1.0169, lr_0 = 1.4139e-04
Validation auc = 0.896410
Validation accuracy = 0.957143
Epoch 25
Loss = 8.9896e-02, PNorm = 36.6636, GNorm = 0.2582, lr_0 = 1.3791e-04
Loss = 7.2193e-02, PNorm = 36.6771, GNorm = 0.6288, lr_0 = 1.3452e-04
Loss = 1.0348e-01, PNorm = 36.6861, GNorm = 0.5473, lr_0 = 1.3121e-04
Validation auc = 0.896068
Validation accuracy = 0.942857
Epoch 26
Loss = 1.0090e-01, PNorm = 36.6969, GNorm = 0.8642, lr_0 = 1.2766e-04
Loss = 7.8457e-02, PNorm = 36.7080, GNorm = 0.4325, lr_0 = 1.2452e-04
Loss = 7.9395e-02, PNorm = 36.7200, GNorm = 0.5457, lr_0 = 1.2146e-04
Validation auc = 0.895726
Validation accuracy = 0.966667
Epoch 27
Loss = 6.8809e-02, PNorm = 36.7248, GNorm = 0.3387, lr_0 = 1.1847e-04
Loss = 9.2063e-02, PNorm = 36.7332, GNorm = 0.7542, lr_0 = 1.1555e-04
Loss = 8.6152e-02, PNorm = 36.7423, GNorm = 0.7348, lr_0 = 1.1271e-04
Loss = 7.0953e-02, PNorm = 36.7505, GNorm = 0.7974, lr_0 = 1.0993e-04
Loss = 7.0541e-02, PNorm = 36.7514, GNorm = 1.2028, lr_0 = 1.0966e-04
Validation auc = 0.894701
Validation accuracy = 0.961905
Epoch 28
Loss = 7.9173e-02, PNorm = 36.7596, GNorm = 0.6239, lr_0 = 1.0696e-04
Loss = 9.9208e-02, PNorm = 36.7674, GNorm = 0.8631, lr_0 = 1.0433e-04
Loss = 7.0555e-02, PNorm = 36.7793, GNorm = 0.6317, lr_0 = 1.0176e-04
Validation auc = 0.892991
Validation accuracy = 0.961905
Epoch 29
Loss = 1.2477e-01, PNorm = 36.7860, GNorm = 0.8454, lr_0 = 1.0000e-04
Loss = 7.1825e-02, PNorm = 36.7971, GNorm = 0.3933, lr_0 = 1.0000e-04
Loss = 5.9989e-02, PNorm = 36.8060, GNorm = 0.7265, lr_0 = 1.0000e-04
Validation auc = 0.893675
Validation accuracy = 0.961905
Model 0 best validation auc = 0.929231 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.983374
Model 0 test accuracy = 0.981043
Ensemble test auc = 0.983374
Ensemble test accuracy = 0.981043
Fold 1
Splitting data with seed 43
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 3.9063e-01, PNorm = 34.0186, GNorm = 0.3215, lr_0 = 2.5000e-04
Loss = 2.3622e-01, PNorm = 34.0278, GNorm = 0.1392, lr_0 = 3.8636e-04
Loss = 2.2686e-01, PNorm = 34.0356, GNorm = 0.5043, lr_0 = 5.2273e-04
Validation auc = 0.542841
Validation accuracy = 0.957143
Epoch 1
Loss = 1.9840e-01, PNorm = 34.0559, GNorm = 0.4292, lr_0 = 6.7273e-04
Loss = 1.9506e-01, PNorm = 34.0771, GNorm = 0.2136, lr_0 = 8.0909e-04
Loss = 2.1030e-01, PNorm = 34.1061, GNorm = 0.3526, lr_0 = 9.4545e-04
Validation auc = 0.742952
Validation accuracy = 0.957143
Epoch 2
Loss = 1.4649e-01, PNorm = 34.1401, GNorm = 0.7117, lr_0 = 9.8516e-04
Loss = 1.4644e-01, PNorm = 34.1835, GNorm = 1.4992, lr_0 = 9.6091e-04
Loss = 2.3254e-01, PNorm = 34.2132, GNorm = 0.4749, lr_0 = 9.3726e-04
Loss = 2.2837e-01, PNorm = 34.2330, GNorm = 0.4430, lr_0 = 9.1420e-04
Loss = 2.2802e-01, PNorm = 34.2377, GNorm = 0.2796, lr_0 = 9.1192e-04
Validation auc = 0.755666
Validation accuracy = 0.957143
Epoch 3
Loss = 1.7542e-01, PNorm = 34.2768, GNorm = 0.1699, lr_0 = 8.8948e-04
Loss = 1.9967e-01, PNorm = 34.3085, GNorm = 0.5118, lr_0 = 8.6758e-04
Loss = 1.7665e-01, PNorm = 34.3504, GNorm = 0.2039, lr_0 = 8.4623e-04
Validation auc = 0.758983
Validation accuracy = 0.957143
Epoch 4
Loss = 1.7122e-01, PNorm = 34.3953, GNorm = 0.2025, lr_0 = 8.2540e-04
Loss = 1.5872e-01, PNorm = 34.4504, GNorm = 0.4306, lr_0 = 8.0509e-04
Loss = 2.0512e-01, PNorm = 34.4752, GNorm = 2.8515, lr_0 = 7.8527e-04
Validation auc = 0.798231
Validation accuracy = 0.957143
Epoch 5
Loss = 2.3500e-01, PNorm = 34.5058, GNorm = 0.4459, lr_0 = 7.6595e-04
Loss = 1.5232e-01, PNorm = 34.5432, GNorm = 0.2483, lr_0 = 7.4710e-04
Loss = 1.9617e-01, PNorm = 34.5844, GNorm = 0.2256, lr_0 = 7.2871e-04
Loss = 2.0609e-01, PNorm = 34.6176, GNorm = 0.2814, lr_0 = 7.1077e-04
Validation auc = 0.826976
Validation accuracy = 0.957143
Epoch 6
Loss = 1.6636e-01, PNorm = 34.6650, GNorm = 0.7985, lr_0 = 6.9156e-04
Loss = 1.4258e-01, PNorm = 34.7181, GNorm = 0.1631, lr_0 = 6.7453e-04
Loss = 1.7776e-01, PNorm = 34.7660, GNorm = 0.1849, lr_0 = 6.5793e-04
Validation auc = 0.822001
Validation accuracy = 0.947619
Epoch 7
Loss = 1.7160e-01, PNorm = 34.8023, GNorm = 0.3886, lr_0 = 6.4174e-04
Loss = 1.7238e-01, PNorm = 34.8453, GNorm = 0.3438, lr_0 = 6.2595e-04
Loss = 1.3506e-01, PNorm = 34.9029, GNorm = 0.6685, lr_0 = 6.1054e-04
Validation auc = 0.851299
Validation accuracy = 0.942857
Epoch 8
Loss = 1.4879e-01, PNorm = 34.9639, GNorm = 0.3892, lr_0 = 5.9403e-04
Loss = 1.3006e-01, PNorm = 35.0119, GNorm = 0.3776, lr_0 = 5.7941e-04
Loss = 1.3461e-01, PNorm = 35.0605, GNorm = 0.6919, lr_0 = 5.6515e-04
Loss = 1.8820e-01, PNorm = 35.0986, GNorm = 0.7692, lr_0 = 5.5124e-04
Validation auc = 0.841349
Validation accuracy = 0.947619
Epoch 9
Loss = 1.3561e-01, PNorm = 35.1321, GNorm = 0.4541, lr_0 = 5.3767e-04
Loss = 1.5196e-01, PNorm = 35.1812, GNorm = 0.6828, lr_0 = 5.2444e-04
Loss = 1.2288e-01, PNorm = 35.2233, GNorm = 0.8318, lr_0 = 5.1153e-04
Validation auc = 0.851299
Validation accuracy = 0.942857
Epoch 10
Loss = 1.0748e-01, PNorm = 35.2621, GNorm = 0.7480, lr_0 = 4.9894e-04
Loss = 1.9346e-01, PNorm = 35.3092, GNorm = 0.7199, lr_0 = 4.8666e-04
Loss = 1.0584e-01, PNorm = 35.3545, GNorm = 0.3997, lr_0 = 4.7469e-04
Validation auc = 0.864566
Validation accuracy = 0.947619
Epoch 11
Loss = 6.5696e-02, PNorm = 35.3856, GNorm = 0.7936, lr_0 = 4.6185e-04
Loss = 1.1474e-01, PNorm = 35.4324, GNorm = 0.2869, lr_0 = 4.5048e-04
Loss = 1.4066e-01, PNorm = 35.4581, GNorm = 0.8428, lr_0 = 4.3940e-04
Loss = 1.4503e-01, PNorm = 35.4905, GNorm = 0.5499, lr_0 = 4.2858e-04
Validation auc = 0.878939
Validation accuracy = 0.947619
Epoch 12
Loss = 1.6032e-01, PNorm = 35.5283, GNorm = 0.6500, lr_0 = 4.1803e-04
Loss = 9.1110e-02, PNorm = 35.5604, GNorm = 0.2841, lr_0 = 4.0775e-04
Loss = 1.2236e-01, PNorm = 35.5931, GNorm = 0.2193, lr_0 = 3.9771e-04
Validation auc = 0.878939
Validation accuracy = 0.938095
Epoch 13
Loss = 8.8097e-02, PNorm = 35.6367, GNorm = 0.9043, lr_0 = 3.8696e-04
Loss = 1.5709e-01, PNorm = 35.6649, GNorm = 1.0413, lr_0 = 3.7743e-04
Loss = 1.4271e-01, PNorm = 35.7002, GNorm = 0.7316, lr_0 = 3.6814e-04
Loss = 9.6432e-02, PNorm = 35.7319, GNorm = 0.2851, lr_0 = 3.5908e-04
Validation auc = 0.909895
Validation accuracy = 0.961905
Epoch 14
Loss = 1.2894e-01, PNorm = 35.7561, GNorm = 0.8976, lr_0 = 3.5025e-04
Loss = 9.1513e-02, PNorm = 35.7899, GNorm = 1.2254, lr_0 = 3.4163e-04
Loss = 1.5220e-01, PNorm = 35.7984, GNorm = 0.6706, lr_0 = 3.3322e-04
Validation auc = 0.894970
Validation accuracy = 0.957143
Epoch 15
Loss = 1.1799e-01, PNorm = 35.8279, GNorm = 0.3479, lr_0 = 3.2502e-04
Loss = 1.3329e-01, PNorm = 35.8580, GNorm = 1.1890, lr_0 = 3.1702e-04
Loss = 9.6001e-02, PNorm = 35.8817, GNorm = 0.7621, lr_0 = 3.0921e-04
Validation auc = 0.920951
Validation accuracy = 0.952381
Epoch 16
Loss = 7.5370e-02, PNorm = 35.9080, GNorm = 0.5539, lr_0 = 3.0085e-04
Loss = 1.2115e-01, PNorm = 35.9287, GNorm = 0.3227, lr_0 = 2.9345e-04
Loss = 8.4060e-02, PNorm = 35.9488, GNorm = 0.3849, lr_0 = 2.8623e-04
Loss = 1.1791e-01, PNorm = 35.9649, GNorm = 0.6203, lr_0 = 2.7918e-04
Validation auc = 0.919845
Validation accuracy = 0.952381
Epoch 17
Loss = 8.2298e-02, PNorm = 35.9924, GNorm = 1.4611, lr_0 = 2.7231e-04
Loss = 1.0907e-01, PNorm = 36.0086, GNorm = 1.4375, lr_0 = 2.6561e-04
Loss = 1.0184e-01, PNorm = 36.0290, GNorm = 0.8896, lr_0 = 2.5907e-04
Validation auc = 0.943615
Validation accuracy = 0.947619
Epoch 18
Loss = 1.1057e-01, PNorm = 36.0419, GNorm = 1.1531, lr_0 = 2.5207e-04
Loss = 9.7343e-02, PNorm = 36.0670, GNorm = 0.5336, lr_0 = 2.4586e-04
Loss = 1.0724e-01, PNorm = 36.0839, GNorm = 0.8249, lr_0 = 2.3981e-04
Validation auc = 0.951907
Validation accuracy = 0.952381
Epoch 19
Loss = 7.1026e-02, PNorm = 36.1052, GNorm = 0.4717, lr_0 = 2.3391e-04
Loss = 1.4089e-01, PNorm = 36.1155, GNorm = 0.5797, lr_0 = 2.2815e-04
Loss = 8.8399e-02, PNorm = 36.1373, GNorm = 0.8279, lr_0 = 2.2254e-04
Loss = 1.0859e-01, PNorm = 36.1527, GNorm = 0.4000, lr_0 = 2.1706e-04
Validation auc = 0.943615
Validation accuracy = 0.947619
Epoch 20
Loss = 1.1030e-01, PNorm = 36.1703, GNorm = 1.8688, lr_0 = 2.1172e-04
Loss = 9.1095e-02, PNorm = 36.1888, GNorm = 0.3679, lr_0 = 2.0651e-04
Loss = 1.0777e-01, PNorm = 36.1974, GNorm = 0.8080, lr_0 = 2.0142e-04
Validation auc = 0.948590
Validation accuracy = 0.952381
Epoch 21
Loss = 1.2573e-01, PNorm = 36.2127, GNorm = 0.7486, lr_0 = 1.9598e-04
Loss = 1.2164e-01, PNorm = 36.2270, GNorm = 0.3534, lr_0 = 1.9115e-04
Loss = 8.3921e-02, PNorm = 36.2434, GNorm = 0.4357, lr_0 = 1.8645e-04
Validation auc = 0.954118
Validation accuracy = 0.952381
Epoch 22
Loss = 7.7350e-02, PNorm = 36.2578, GNorm = 0.5787, lr_0 = 1.8186e-04
Loss = 8.1504e-02, PNorm = 36.2705, GNorm = 1.2634, lr_0 = 1.7739e-04
Loss = 8.5905e-02, PNorm = 36.2819, GNorm = 1.5626, lr_0 = 1.7302e-04
Loss = 1.2698e-01, PNorm = 36.2897, GNorm = 1.5010, lr_0 = 1.6876e-04
Validation auc = 0.953013
Validation accuracy = 0.961905
Epoch 23
Loss = 7.5826e-02, PNorm = 36.3009, GNorm = 0.2110, lr_0 = 1.6420e-04
Loss = 1.2912e-01, PNorm = 36.3117, GNorm = 0.6381, lr_0 = 1.6016e-04
Loss = 6.8161e-02, PNorm = 36.3274, GNorm = 0.6150, lr_0 = 1.5622e-04
Validation auc = 0.948590
Validation accuracy = 0.947619
Epoch 24
Loss = 1.0675e-01, PNorm = 36.3375, GNorm = 0.5984, lr_0 = 1.5237e-04
Loss = 1.1795e-01, PNorm = 36.3523, GNorm = 0.3444, lr_0 = 1.4862e-04
Loss = 6.1755e-02, PNorm = 36.3644, GNorm = 0.8247, lr_0 = 1.4496e-04
Loss = 8.2344e-02, PNorm = 36.3738, GNorm = 0.9675, lr_0 = 1.4139e-04
Validation auc = 0.951354
Validation accuracy = 0.947619
Epoch 25
Loss = 9.3255e-02, PNorm = 36.3850, GNorm = 0.6364, lr_0 = 1.3791e-04
Loss = 1.0351e-01, PNorm = 36.3960, GNorm = 0.5851, lr_0 = 1.3452e-04
Loss = 7.8062e-02, PNorm = 36.4016, GNorm = 0.5086, lr_0 = 1.3121e-04
Validation auc = 0.950249
Validation accuracy = 0.947619
Epoch 26
Loss = 7.2323e-02, PNorm = 36.4134, GNorm = 0.5561, lr_0 = 1.2766e-04
Loss = 9.9838e-02, PNorm = 36.4200, GNorm = 0.7848, lr_0 = 1.2452e-04
Loss = 8.5762e-02, PNorm = 36.4347, GNorm = 1.6176, lr_0 = 1.2146e-04
Validation auc = 0.947485
Validation accuracy = 0.957143
Epoch 27
Loss = 7.5004e-02, PNorm = 36.4427, GNorm = 1.2144, lr_0 = 1.1847e-04
Loss = 8.3747e-02, PNorm = 36.4503, GNorm = 1.2384, lr_0 = 1.1555e-04
Loss = 1.0760e-01, PNorm = 36.4586, GNorm = 1.4640, lr_0 = 1.1271e-04
Loss = 5.6507e-02, PNorm = 36.4650, GNorm = 0.9043, lr_0 = 1.0993e-04
Loss = 1.4477e-01, PNorm = 36.4659, GNorm = 1.0416, lr_0 = 1.0966e-04
Validation auc = 0.956329
Validation accuracy = 0.947619
Epoch 28
Loss = 7.2496e-02, PNorm = 36.4749, GNorm = 0.7894, lr_0 = 1.0696e-04
Loss = 7.5399e-02, PNorm = 36.4826, GNorm = 0.6644, lr_0 = 1.0433e-04
Loss = 7.5988e-02, PNorm = 36.4905, GNorm = 0.2955, lr_0 = 1.0176e-04
Validation auc = 0.957988
Validation accuracy = 0.952381
Epoch 29
Loss = 9.0010e-02, PNorm = 36.4949, GNorm = 0.5192, lr_0 = 1.0000e-04
Loss = 7.4963e-02, PNorm = 36.5039, GNorm = 1.1791, lr_0 = 1.0000e-04
Loss = 7.8400e-02, PNorm = 36.5135, GNorm = 0.3729, lr_0 = 1.0000e-04
Validation auc = 0.954671
Validation accuracy = 0.947619
Model 0 best validation auc = 0.957988 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.995122
Model 0 test accuracy = 0.985782
Ensemble test auc = 0.995122
Ensemble test accuracy = 0.985782
Fold 2
Splitting data with seed 44
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 4.1856e-01, PNorm = 34.0184, GNorm = 1.4209, lr_0 = 2.5000e-04
Loss = 2.6216e-01, PNorm = 34.0269, GNorm = 0.4864, lr_0 = 3.8636e-04
Loss = 2.1960e-01, PNorm = 34.0389, GNorm = 0.2000, lr_0 = 5.2273e-04
Validation auc = 0.681133
Validation accuracy = 0.947619
Epoch 1
Loss = 2.2354e-01, PNorm = 34.0560, GNorm = 0.8090, lr_0 = 6.7273e-04
Loss = 1.7003e-01, PNorm = 34.0774, GNorm = 0.2881, lr_0 = 8.0909e-04
Loss = 2.1725e-01, PNorm = 34.0956, GNorm = 0.4304, lr_0 = 9.4545e-04
Validation auc = 0.514847
Validation accuracy = 0.947619
Epoch 2
Loss = 2.2962e-01, PNorm = 34.1229, GNorm = 0.2534, lr_0 = 9.8516e-04
Loss = 1.7222e-01, PNorm = 34.1654, GNorm = 0.5986, lr_0 = 9.6091e-04
Loss = 1.6317e-01, PNorm = 34.2095, GNorm = 0.2677, lr_0 = 9.3726e-04
Loss = 2.7015e-01, PNorm = 34.2272, GNorm = 0.6186, lr_0 = 9.1420e-04
Loss = 2.1328e-01, PNorm = 34.2306, GNorm = 0.4074, lr_0 = 9.1192e-04
Validation auc = 0.528552
Validation accuracy = 0.947619
Epoch 3
Loss = 1.7433e-01, PNorm = 34.2776, GNorm = 0.9905, lr_0 = 8.8948e-04
Loss = 1.9425e-01, PNorm = 34.3076, GNorm = 0.5794, lr_0 = 8.6758e-04
Loss = 1.8628e-01, PNorm = 34.3441, GNorm = 0.3242, lr_0 = 8.4623e-04
Validation auc = 0.516217
Validation accuracy = 0.947619
Epoch 4
Loss = 1.6577e-01, PNorm = 34.3979, GNorm = 0.2619, lr_0 = 8.2540e-04
Loss = 1.7319e-01, PNorm = 34.4401, GNorm = 0.7415, lr_0 = 8.0509e-04
Loss = 2.0625e-01, PNorm = 34.4869, GNorm = 1.0206, lr_0 = 7.8527e-04
Validation auc = 0.535404
Validation accuracy = 0.947619
Epoch 5
Loss = 2.2895e-01, PNorm = 34.5135, GNorm = 0.3478, lr_0 = 7.6595e-04
Loss = 1.7897e-01, PNorm = 34.5721, GNorm = 0.1674, lr_0 = 7.4710e-04
Loss = 1.7865e-01, PNorm = 34.6188, GNorm = 0.5321, lr_0 = 7.2871e-04
Loss = 1.5152e-01, PNorm = 34.6697, GNorm = 0.3177, lr_0 = 7.1077e-04
Validation auc = 0.566012
Validation accuracy = 0.947619
Epoch 6
Loss = 1.4432e-01, PNorm = 34.7211, GNorm = 0.3153, lr_0 = 6.9156e-04
Loss = 1.5826e-01, PNorm = 34.7699, GNorm = 0.2511, lr_0 = 6.7453e-04
Loss = 1.7994e-01, PNorm = 34.8103, GNorm = 0.7782, lr_0 = 6.5793e-04
Validation auc = 0.677935
Validation accuracy = 0.947619
Epoch 7
Loss = 1.5275e-01, PNorm = 34.8645, GNorm = 1.3307, lr_0 = 6.4174e-04
Loss = 1.5445e-01, PNorm = 34.9183, GNorm = 0.3163, lr_0 = 6.2595e-04
Loss = 1.6613e-01, PNorm = 34.9602, GNorm = 1.1266, lr_0 = 6.1054e-04
Validation auc = 0.651896
Validation accuracy = 0.947619
Epoch 8
Loss = 2.8788e-01, PNorm = 35.0077, GNorm = 0.5379, lr_0 = 5.9403e-04
Loss = 1.3994e-01, PNorm = 35.0591, GNorm = 0.5498, lr_0 = 5.7941e-04
Loss = 1.1982e-01, PNorm = 35.1186, GNorm = 0.8968, lr_0 = 5.6515e-04
Loss = 1.3808e-01, PNorm = 35.1729, GNorm = 0.8144, lr_0 = 5.5124e-04
Validation auc = 0.684788
Validation accuracy = 0.947619
Epoch 9
Loss = 9.6768e-02, PNorm = 35.2228, GNorm = 0.7329, lr_0 = 5.3767e-04
Loss = 1.9300e-01, PNorm = 35.2542, GNorm = 0.7811, lr_0 = 5.2444e-04
Loss = 1.2008e-01, PNorm = 35.2921, GNorm = 0.2706, lr_0 = 5.1153e-04
Validation auc = 0.752855
Validation accuracy = 0.947619
Epoch 10
Loss = 1.7573e-01, PNorm = 35.3426, GNorm = 0.2025, lr_0 = 4.9894e-04
Loss = 1.1618e-01, PNorm = 35.3899, GNorm = 0.5408, lr_0 = 4.8666e-04
Loss = 1.1240e-01, PNorm = 35.4298, GNorm = 1.0586, lr_0 = 4.7469e-04
Validation auc = 0.736409
Validation accuracy = 0.957143
Epoch 11
Loss = 6.5742e-02, PNorm = 35.4623, GNorm = 0.2312, lr_0 = 4.6185e-04
Loss = 1.2370e-01, PNorm = 35.4937, GNorm = 0.2983, lr_0 = 4.5048e-04
Loss = 1.1677e-01, PNorm = 35.5266, GNorm = 0.4275, lr_0 = 4.3940e-04
Loss = 1.6184e-01, PNorm = 35.5661, GNorm = 0.5730, lr_0 = 4.2858e-04
Validation auc = 0.731841
Validation accuracy = 0.947619
Epoch 12
Loss = 1.0711e-01, PNorm = 35.5969, GNorm = 0.5667, lr_0 = 4.1803e-04
Loss = 1.1179e-01, PNorm = 35.6265, GNorm = 0.6537, lr_0 = 4.0775e-04
Loss = 1.5124e-01, PNorm = 35.6635, GNorm = 0.9721, lr_0 = 3.9771e-04
Validation auc = 0.732755
Validation accuracy = 0.957143
Epoch 13
Loss = 1.1892e-01, PNorm = 35.6983, GNorm = 0.3708, lr_0 = 3.8696e-04
Loss = 8.8758e-02, PNorm = 35.7312, GNorm = 0.6176, lr_0 = 3.7743e-04
Loss = 1.6326e-01, PNorm = 35.7577, GNorm = 0.6597, lr_0 = 3.6814e-04
Loss = 1.1964e-01, PNorm = 35.7810, GNorm = 1.1010, lr_0 = 3.5908e-04
Validation auc = 0.771128
Validation accuracy = 0.947619
Epoch 14
Loss = 1.1398e-01, PNorm = 35.8088, GNorm = 0.6647, lr_0 = 3.5025e-04
Loss = 1.1099e-01, PNorm = 35.8462, GNorm = 0.3450, lr_0 = 3.4163e-04
Loss = 1.1038e-01, PNorm = 35.8752, GNorm = 0.3738, lr_0 = 3.3322e-04
Validation auc = 0.721334
Validation accuracy = 0.957143
Epoch 15
Loss = 1.0467e-01, PNorm = 35.9017, GNorm = 0.6834, lr_0 = 3.2502e-04
Loss = 6.8446e-02, PNorm = 35.9247, GNorm = 0.5595, lr_0 = 3.1702e-04
Loss = 1.2298e-01, PNorm = 35.9497, GNorm = 0.9318, lr_0 = 3.0921e-04
Validation auc = 0.762449
Validation accuracy = 0.923810
Epoch 16
Loss = 1.6980e-01, PNorm = 35.9756, GNorm = 0.4986, lr_0 = 3.0085e-04
Loss = 9.5400e-02, PNorm = 36.0090, GNorm = 0.5920, lr_0 = 2.9345e-04
Loss = 1.0827e-01, PNorm = 36.0329, GNorm = 0.4753, lr_0 = 2.8623e-04
Loss = 1.0590e-01, PNorm = 36.0683, GNorm = 0.5993, lr_0 = 2.7918e-04
Validation auc = 0.759251
Validation accuracy = 0.952381
Epoch 17
Loss = 1.2235e-01, PNorm = 36.0912, GNorm = 0.3535, lr_0 = 2.7231e-04
Loss = 1.0822e-01, PNorm = 36.1140, GNorm = 0.8021, lr_0 = 2.6561e-04
Loss = 8.1742e-02, PNorm = 36.1329, GNorm = 0.2228, lr_0 = 2.5907e-04
Validation auc = 0.804934
Validation accuracy = 0.952381
Epoch 18
Loss = 9.8952e-02, PNorm = 36.1555, GNorm = 0.2825, lr_0 = 2.5207e-04
Loss = 9.6161e-02, PNorm = 36.1779, GNorm = 0.4839, lr_0 = 2.4586e-04
Loss = 9.2772e-02, PNorm = 36.1999, GNorm = 1.0942, lr_0 = 2.3981e-04
Validation auc = 0.806304
Validation accuracy = 0.942857
Epoch 19
Loss = 5.1990e-02, PNorm = 36.2183, GNorm = 0.4119, lr_0 = 2.3391e-04
Loss = 1.0460e-01, PNorm = 36.2434, GNorm = 0.8660, lr_0 = 2.2815e-04
Loss = 1.0425e-01, PNorm = 36.2671, GNorm = 0.2911, lr_0 = 2.2254e-04
Loss = 8.6050e-02, PNorm = 36.2878, GNorm = 1.7062, lr_0 = 2.1706e-04
Validation auc = 0.794884
Validation accuracy = 0.957143
Epoch 20
Loss = 8.9338e-02, PNorm = 36.3013, GNorm = 0.5671, lr_0 = 2.1172e-04
Loss = 9.3520e-02, PNorm = 36.3214, GNorm = 0.9179, lr_0 = 2.0651e-04
Loss = 8.8420e-02, PNorm = 36.3409, GNorm = 0.3393, lr_0 = 2.0142e-04
Validation auc = 0.804020
Validation accuracy = 0.933333
Epoch 21
Loss = 9.5789e-02, PNorm = 36.3555, GNorm = 0.2913, lr_0 = 1.9598e-04
Loss = 7.9164e-02, PNorm = 36.3721, GNorm = 0.2907, lr_0 = 1.9115e-04
Loss = 9.8482e-02, PNorm = 36.3855, GNorm = 1.0998, lr_0 = 1.8645e-04
Validation auc = 0.796711
Validation accuracy = 0.957143
Epoch 22
Loss = 1.5770e-01, PNorm = 36.4041, GNorm = 0.5739, lr_0 = 1.8186e-04
Loss = 9.5669e-02, PNorm = 36.4142, GNorm = 0.9029, lr_0 = 1.7739e-04
Loss = 7.0042e-02, PNorm = 36.4285, GNorm = 0.7233, lr_0 = 1.7302e-04
Loss = 8.6449e-02, PNorm = 36.4405, GNorm = 1.0264, lr_0 = 1.6876e-04
Validation auc = 0.808588
Validation accuracy = 0.933333
Epoch 23
Loss = 9.0118e-02, PNorm = 36.4598, GNorm = 0.7504, lr_0 = 1.6420e-04
Loss = 8.3076e-02, PNorm = 36.4701, GNorm = 0.8840, lr_0 = 1.6016e-04
Loss = 8.8238e-02, PNorm = 36.4878, GNorm = 0.3297, lr_0 = 1.5622e-04
Validation auc = 0.793513
Validation accuracy = 0.957143
Epoch 24
Loss = 1.2700e-01, PNorm = 36.5019, GNorm = 1.2586, lr_0 = 1.5237e-04
Loss = 7.5875e-02, PNorm = 36.5130, GNorm = 1.1519, lr_0 = 1.4862e-04
Loss = 8.3052e-02, PNorm = 36.5271, GNorm = 0.8165, lr_0 = 1.4496e-04
Loss = 6.5635e-02, PNorm = 36.5373, GNorm = 0.6463, lr_0 = 1.4139e-04
Validation auc = 0.819095
Validation accuracy = 0.947619
Epoch 25
Loss = 8.0727e-02, PNorm = 36.5510, GNorm = 1.9986, lr_0 = 1.3791e-04
Loss = 8.6979e-02, PNorm = 36.5645, GNorm = 0.5818, lr_0 = 1.3452e-04
Loss = 6.6493e-02, PNorm = 36.5760, GNorm = 0.4287, lr_0 = 1.3121e-04
Validation auc = 0.809959
Validation accuracy = 0.952381
Epoch 26
Loss = 5.9494e-02, PNorm = 36.5879, GNorm = 0.2861, lr_0 = 1.2766e-04
Loss = 7.4155e-02, PNorm = 36.5960, GNorm = 0.4527, lr_0 = 1.2452e-04
Loss = 7.5120e-02, PNorm = 36.6085, GNorm = 0.4426, lr_0 = 1.2146e-04
Validation auc = 0.817725
Validation accuracy = 0.942857
Epoch 27
Loss = 5.0895e-02, PNorm = 36.6169, GNorm = 0.5809, lr_0 = 1.1847e-04
Loss = 9.1787e-02, PNorm = 36.6270, GNorm = 0.2000, lr_0 = 1.1555e-04
Loss = 5.8076e-02, PNorm = 36.6395, GNorm = 0.7937, lr_0 = 1.1271e-04
Loss = 6.9308e-02, PNorm = 36.6500, GNorm = 0.3551, lr_0 = 1.0993e-04
Loss = 1.7145e-01, PNorm = 36.6508, GNorm = 0.6486, lr_0 = 1.0966e-04
Validation auc = 0.823207
Validation accuracy = 0.952381
Epoch 28
Loss = 7.9931e-02, PNorm = 36.6557, GNorm = 0.7737, lr_0 = 1.0696e-04
Loss = 7.0544e-02, PNorm = 36.6677, GNorm = 0.9565, lr_0 = 1.0433e-04
Loss = 8.4592e-02, PNorm = 36.6741, GNorm = 0.2602, lr_0 = 1.0176e-04
Validation auc = 0.814984
Validation accuracy = 0.947619
Epoch 29
Loss = 3.8341e-02, PNorm = 36.6851, GNorm = 0.4259, lr_0 = 1.0000e-04
Loss = 6.3584e-02, PNorm = 36.6940, GNorm = 1.0348, lr_0 = 1.0000e-04
Loss = 7.2981e-02, PNorm = 36.7023, GNorm = 1.0838, lr_0 = 1.0000e-04
Validation auc = 0.820009
Validation accuracy = 0.947619
Model 0 best validation auc = 0.823207 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.839837
Model 0 test accuracy = 0.976303
Ensemble test auc = 0.839837
Ensemble test accuracy = 0.976303
3-fold cross validation
	Seed 42 ==> test auc = 0.983374
	Seed 42 ==> test accuracy = 0.981043
	Seed 43 ==> test auc = 0.995122
	Seed 43 ==> test accuracy = 0.985782
	Seed 44 ==> test auc = 0.839837
	Seed 44 ==> test accuracy = 0.976303
Overall test auc = 0.939445 +/- 0.070596
Overall test accuracy = 0.981043 +/- 0.003870
Elapsed time = 0:14:10
