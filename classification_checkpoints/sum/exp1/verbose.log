Command line
python /Users/anastasiakuznecova/PycharmProjects/chemprop-master/Testing Chemprop for project.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'sum',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'tests/data/Halicin_train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'classification_checkpoints/sum/exp1/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Could not write the reproducibility section of the arguments to file, thus omitting this section.
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 5.7000e-01, PNorm = 34.0104, GNorm = 5.4840, lr_0 = 2.5000e-04
Loss = 2.4675e-01, PNorm = 34.0130, GNorm = 11.4178, lr_0 = 3.8636e-04
Loss = 4.0258e-01, PNorm = 34.0165, GNorm = 33.1878, lr_0 = 5.2273e-04
Validation auc = 0.573333
Validation accuracy = 0.928571
Epoch 1
Loss = 2.5641e-01, PNorm = 34.0235, GNorm = 3.4427, lr_0 = 6.7273e-04
Loss = 3.9038e-01, PNorm = 34.0313, GNorm = 17.3776, lr_0 = 8.0909e-04
Loss = 3.1339e-01, PNorm = 34.0432, GNorm = 1.8455, lr_0 = 9.4545e-04
Validation auc = 0.839658
Validation accuracy = 0.938095
Epoch 2
Loss = 2.8381e-01, PNorm = 34.0583, GNorm = 3.7713, lr_0 = 9.8516e-04
Loss = 2.5444e-01, PNorm = 34.0763, GNorm = 1.6875, lr_0 = 9.6091e-04
Loss = 1.9502e-01, PNorm = 34.0907, GNorm = 11.3182, lr_0 = 9.3726e-04
Loss = 2.1666e-01, PNorm = 34.1065, GNorm = 3.3868, lr_0 = 9.1420e-04
Loss = 1.5249e-01, PNorm = 34.1083, GNorm = 2.7629, lr_0 = 9.1192e-04
Validation auc = 0.751453
Validation accuracy = 0.928571
Epoch 3
Loss = 2.2975e-01, PNorm = 34.1266, GNorm = 5.9468, lr_0 = 8.8948e-04
Loss = 2.1517e-01, PNorm = 34.1471, GNorm = 1.5220, lr_0 = 8.6758e-04
Loss = 2.0127e-01, PNorm = 34.1669, GNorm = 0.7720, lr_0 = 8.4623e-04
Validation auc = 0.883077
Validation accuracy = 0.933333
Epoch 4
Loss = 2.0708e-01, PNorm = 34.1871, GNorm = 4.6096, lr_0 = 8.2540e-04
Loss = 1.6680e-01, PNorm = 34.2135, GNorm = 1.9683, lr_0 = 8.0509e-04
Loss = 2.0808e-01, PNorm = 34.2336, GNorm = 5.9324, lr_0 = 7.8527e-04
Validation auc = 0.917949
Validation accuracy = 0.947619
Epoch 5
Loss = 1.1924e-01, PNorm = 34.2519, GNorm = 2.0286, lr_0 = 7.6595e-04
Loss = 1.8080e-01, PNorm = 34.2728, GNorm = 6.3848, lr_0 = 7.4710e-04
Loss = 1.6387e-01, PNorm = 34.2947, GNorm = 1.8605, lr_0 = 7.2871e-04
Loss = 1.5892e-01, PNorm = 34.3152, GNorm = 0.9674, lr_0 = 7.1077e-04
Validation auc = 0.867009
Validation accuracy = 0.933333
Epoch 6
Loss = 1.3239e-01, PNorm = 34.3324, GNorm = 2.7647, lr_0 = 6.9156e-04
Loss = 1.2475e-01, PNorm = 34.3531, GNorm = 3.9520, lr_0 = 6.7453e-04
Loss = 1.9818e-01, PNorm = 34.3751, GNorm = 1.5459, lr_0 = 6.5793e-04
Validation auc = 0.861538
Validation accuracy = 0.928571
Epoch 7
Loss = 1.3722e-01, PNorm = 34.3953, GNorm = 4.5125, lr_0 = 6.4174e-04
Loss = 1.5268e-01, PNorm = 34.4168, GNorm = 4.6127, lr_0 = 6.2595e-04
Loss = 1.7382e-01, PNorm = 34.4364, GNorm = 2.0060, lr_0 = 6.1054e-04
Validation auc = 0.952137
Validation accuracy = 0.961905
Epoch 8
Loss = 1.1921e-01, PNorm = 34.4584, GNorm = 1.8423, lr_0 = 5.9403e-04
Loss = 1.1087e-01, PNorm = 34.4786, GNorm = 5.6032, lr_0 = 5.7941e-04
Loss = 1.1973e-01, PNorm = 34.4946, GNorm = 4.5874, lr_0 = 5.6515e-04
Loss = 1.7863e-01, PNorm = 34.5099, GNorm = 3.1415, lr_0 = 5.5124e-04
Validation auc = 0.933675
Validation accuracy = 0.928571
Epoch 9
Loss = 1.4674e-01, PNorm = 34.5283, GNorm = 3.2800, lr_0 = 5.3767e-04
Loss = 1.6623e-01, PNorm = 34.5493, GNorm = 3.7197, lr_0 = 5.2444e-04
Loss = 9.4264e-02, PNorm = 34.5679, GNorm = 3.1600, lr_0 = 5.1153e-04
Validation auc = 0.930256
Validation accuracy = 0.966667
Epoch 10
Loss = 8.2797e-02, PNorm = 34.5841, GNorm = 0.9457, lr_0 = 4.9894e-04
Loss = 1.2606e-01, PNorm = 34.5988, GNorm = 3.8880, lr_0 = 4.8666e-04
Loss = 1.0991e-01, PNorm = 34.6163, GNorm = 3.9361, lr_0 = 4.7469e-04
Validation auc = 0.920000
Validation accuracy = 0.966667
Epoch 11
Loss = 2.3055e-01, PNorm = 34.6360, GNorm = 3.5272, lr_0 = 4.6185e-04
Loss = 9.6100e-02, PNorm = 34.6531, GNorm = 1.4128, lr_0 = 4.5048e-04
Loss = 1.1390e-01, PNorm = 34.6700, GNorm = 1.7358, lr_0 = 4.3940e-04
Loss = 1.3071e-01, PNorm = 34.6858, GNorm = 2.9251, lr_0 = 4.2858e-04
Validation auc = 0.954188
Validation accuracy = 0.942857
Epoch 12
Loss = 1.0009e-01, PNorm = 34.7015, GNorm = 0.4402, lr_0 = 4.1803e-04
Loss = 1.2825e-01, PNorm = 34.7176, GNorm = 2.3560, lr_0 = 4.0775e-04
Loss = 1.1160e-01, PNorm = 34.7321, GNorm = 0.5878, lr_0 = 3.9771e-04
Validation auc = 0.948376
Validation accuracy = 0.971429
Epoch 13
Loss = 7.2899e-02, PNorm = 34.7462, GNorm = 0.8648, lr_0 = 3.8696e-04
Loss = 1.1978e-01, PNorm = 34.7561, GNorm = 1.4945, lr_0 = 3.7743e-04
Loss = 8.5459e-02, PNorm = 34.7692, GNorm = 1.5224, lr_0 = 3.6814e-04
Loss = 9.9289e-02, PNorm = 34.7829, GNorm = 0.7916, lr_0 = 3.5908e-04
Validation auc = 0.934701
Validation accuracy = 0.976190
Epoch 14
Loss = 9.1701e-02, PNorm = 34.7967, GNorm = 2.3250, lr_0 = 3.5025e-04
Loss = 1.2052e-01, PNorm = 34.8087, GNorm = 3.4843, lr_0 = 3.4163e-04
Loss = 8.2312e-02, PNorm = 34.8184, GNorm = 1.6032, lr_0 = 3.3322e-04
Validation auc = 0.912137
Validation accuracy = 0.952381
Epoch 15
Loss = 9.0454e-02, PNorm = 34.8325, GNorm = 1.7707, lr_0 = 3.2502e-04
Loss = 1.1608e-01, PNorm = 34.8456, GNorm = 1.0350, lr_0 = 3.1702e-04
Loss = 8.0149e-02, PNorm = 34.8579, GNorm = 1.6551, lr_0 = 3.0921e-04
Validation auc = 0.960342
Validation accuracy = 0.976190
Epoch 16
Loss = 6.1102e-02, PNorm = 34.8696, GNorm = 0.9497, lr_0 = 3.0085e-04
Loss = 8.5560e-02, PNorm = 34.8791, GNorm = 3.0456, lr_0 = 2.9345e-04
Loss = 7.6334e-02, PNorm = 34.8906, GNorm = 6.2585, lr_0 = 2.8623e-04
Loss = 1.2110e-01, PNorm = 34.9021, GNorm = 1.3610, lr_0 = 2.7918e-04
Validation auc = 0.937094
Validation accuracy = 0.961905
Epoch 17
Loss = 9.0032e-02, PNorm = 34.9137, GNorm = 0.4518, lr_0 = 2.7231e-04
Loss = 8.3452e-02, PNorm = 34.9251, GNorm = 3.8729, lr_0 = 2.6561e-04
Loss = 9.3520e-02, PNorm = 34.9366, GNorm = 1.9802, lr_0 = 2.5907e-04
Validation auc = 0.969573
Validation accuracy = 0.971429
Epoch 18
Loss = 8.5617e-02, PNorm = 34.9471, GNorm = 1.4819, lr_0 = 2.5207e-04
Loss = 7.5582e-02, PNorm = 34.9567, GNorm = 4.6976, lr_0 = 2.4586e-04
Loss = 9.4986e-02, PNorm = 34.9665, GNorm = 0.9401, lr_0 = 2.3981e-04
Validation auc = 0.935043
Validation accuracy = 0.971429
Epoch 19
Loss = 3.7078e-02, PNorm = 34.9756, GNorm = 0.6110, lr_0 = 2.3391e-04
Loss = 7.3976e-02, PNorm = 34.9846, GNorm = 0.7336, lr_0 = 2.2815e-04
Loss = 7.3596e-02, PNorm = 34.9929, GNorm = 1.0705, lr_0 = 2.2254e-04
Loss = 6.8263e-02, PNorm = 34.9987, GNorm = 1.3008, lr_0 = 2.1706e-04
Validation auc = 0.950427
Validation accuracy = 0.966667
Epoch 20
Loss = 5.3231e-02, PNorm = 35.0055, GNorm = 0.9496, lr_0 = 2.1172e-04
Loss = 7.7968e-02, PNorm = 35.0117, GNorm = 2.1428, lr_0 = 2.0651e-04
Loss = 6.8775e-02, PNorm = 35.0187, GNorm = 7.4382, lr_0 = 2.0142e-04
Validation auc = 0.931282
Validation accuracy = 0.971429
Epoch 21
Loss = 6.2212e-02, PNorm = 35.0269, GNorm = 2.3758, lr_0 = 1.9598e-04
Loss = 7.7876e-02, PNorm = 35.0346, GNorm = 2.7822, lr_0 = 1.9115e-04
Loss = 5.6601e-02, PNorm = 35.0413, GNorm = 0.7943, lr_0 = 1.8645e-04
Validation auc = 0.946325
Validation accuracy = 0.966667
Epoch 22
Loss = 2.8449e-02, PNorm = 35.0478, GNorm = 0.9525, lr_0 = 1.8186e-04
Loss = 5.0006e-02, PNorm = 35.0529, GNorm = 0.8965, lr_0 = 1.7739e-04
Loss = 4.8974e-02, PNorm = 35.0580, GNorm = 0.5839, lr_0 = 1.7302e-04
Loss = 8.1072e-02, PNorm = 35.0646, GNorm = 1.1478, lr_0 = 1.6876e-04
Validation auc = 0.956239
Validation accuracy = 0.976190
Epoch 23
Loss = 3.6540e-02, PNorm = 35.0720, GNorm = 0.6127, lr_0 = 1.6420e-04
Loss = 6.2078e-02, PNorm = 35.0781, GNorm = 0.7131, lr_0 = 1.6016e-04
Loss = 6.4457e-02, PNorm = 35.0841, GNorm = 1.2929, lr_0 = 1.5622e-04
Validation auc = 0.940855
Validation accuracy = 0.971429
Epoch 24
Loss = 4.0270e-02, PNorm = 35.0903, GNorm = 0.7407, lr_0 = 1.5237e-04
Loss = 6.7739e-02, PNorm = 35.0962, GNorm = 2.4459, lr_0 = 1.4862e-04
Loss = 4.8969e-02, PNorm = 35.1020, GNorm = 0.8385, lr_0 = 1.4496e-04
Loss = 6.7182e-02, PNorm = 35.1077, GNorm = 1.8013, lr_0 = 1.4139e-04
Validation auc = 0.940513
Validation accuracy = 0.976190
Epoch 25
Loss = 5.9401e-02, PNorm = 35.1143, GNorm = 0.9123, lr_0 = 1.3791e-04
Loss = 4.5246e-02, PNorm = 35.1202, GNorm = 0.8196, lr_0 = 1.3452e-04
Loss = 6.2644e-02, PNorm = 35.1247, GNorm = 0.4316, lr_0 = 1.3121e-04
Validation auc = 0.952137
Validation accuracy = 0.966667
Epoch 26
Loss = 6.3259e-02, PNorm = 35.1306, GNorm = 1.3945, lr_0 = 1.2766e-04
Loss = 4.3978e-02, PNorm = 35.1353, GNorm = 0.7536, lr_0 = 1.2452e-04
Loss = 4.7982e-02, PNorm = 35.1400, GNorm = 1.1566, lr_0 = 1.2146e-04
Validation auc = 0.947692
Validation accuracy = 0.971429
Epoch 27
Loss = 4.2496e-02, PNorm = 35.1439, GNorm = 0.8149, lr_0 = 1.1847e-04
Loss = 6.5186e-02, PNorm = 35.1477, GNorm = 1.6795, lr_0 = 1.1555e-04
Loss = 5.2778e-02, PNorm = 35.1521, GNorm = 2.1939, lr_0 = 1.1271e-04
Loss = 3.5880e-02, PNorm = 35.1561, GNorm = 1.5256, lr_0 = 1.0993e-04
Loss = 3.2336e-02, PNorm = 35.1564, GNorm = 1.2479, lr_0 = 1.0966e-04
Validation auc = 0.941197
Validation accuracy = 0.971429
Epoch 28
Loss = 4.2394e-02, PNorm = 35.1601, GNorm = 0.9963, lr_0 = 1.0696e-04
Loss = 5.2458e-02, PNorm = 35.1641, GNorm = 1.4731, lr_0 = 1.0433e-04
Loss = 4.7281e-02, PNorm = 35.1687, GNorm = 1.1392, lr_0 = 1.0176e-04
Validation auc = 0.944957
Validation accuracy = 0.971429
Epoch 29
Loss = 6.7940e-02, PNorm = 35.1723, GNorm = 1.5910, lr_0 = 1.0000e-04
Loss = 4.0819e-02, PNorm = 35.1768, GNorm = 1.1021, lr_0 = 1.0000e-04
Loss = 3.8062e-02, PNorm = 35.1804, GNorm = 1.2319, lr_0 = 1.0000e-04
Validation auc = 0.942222
Validation accuracy = 0.971429
Model 0 best validation auc = 0.969573 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.960591
Model 0 test accuracy = 0.976303
Ensemble test auc = 0.960591
Ensemble test accuracy = 0.976303
Fold 1
Splitting data with seed 43
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 6.2040e-01, PNorm = 34.0107, GNorm = 5.7818, lr_0 = 2.5000e-04
Loss = 3.0608e-01, PNorm = 34.0123, GNorm = 3.7826, lr_0 = 3.8636e-04
Loss = 2.8481e-01, PNorm = 34.0159, GNorm = 7.0546, lr_0 = 5.2273e-04
Validation auc = 0.743505
Validation accuracy = 0.919048
Epoch 1
Loss = 3.1845e-01, PNorm = 34.0231, GNorm = 0.5844, lr_0 = 6.7273e-04
Loss = 2.6915e-01, PNorm = 34.0331, GNorm = 24.6377, lr_0 = 8.0909e-04
Loss = 3.3484e-01, PNorm = 34.0457, GNorm = 8.5367, lr_0 = 9.4545e-04
Validation auc = 0.676617
Validation accuracy = 0.957143
Epoch 2
Loss = 3.2175e-01, PNorm = 34.0624, GNorm = 12.6136, lr_0 = 9.8516e-04
Loss = 2.5446e-01, PNorm = 34.0822, GNorm = 9.1851, lr_0 = 9.6091e-04
Loss = 2.7659e-01, PNorm = 34.1042, GNorm = 1.9982, lr_0 = 9.3726e-04
Loss = 2.9135e-01, PNorm = 34.1210, GNorm = 1.8815, lr_0 = 9.1420e-04
Loss = 2.3893e-01, PNorm = 34.1230, GNorm = 2.7782, lr_0 = 9.1192e-04
Validation auc = 0.709232
Validation accuracy = 0.957143
Epoch 3
Loss = 2.2231e-01, PNorm = 34.1433, GNorm = 3.4045, lr_0 = 8.8948e-04
Loss = 1.9151e-01, PNorm = 34.1619, GNorm = 1.7170, lr_0 = 8.6758e-04
Loss = 1.6406e-01, PNorm = 34.1806, GNorm = 3.7220, lr_0 = 8.4623e-04
Validation auc = 0.773908
Validation accuracy = 0.942857
Epoch 4
Loss = 1.6330e-01, PNorm = 34.1989, GNorm = 0.9476, lr_0 = 8.2540e-04
Loss = 1.2920e-01, PNorm = 34.2191, GNorm = 1.2106, lr_0 = 8.0509e-04
Loss = 1.9772e-01, PNorm = 34.2351, GNorm = 13.2189, lr_0 = 7.8527e-04
Validation auc = 0.822001
Validation accuracy = 0.933333
Epoch 5
Loss = 1.5080e-01, PNorm = 34.2542, GNorm = 3.7195, lr_0 = 7.6595e-04
Loss = 1.8878e-01, PNorm = 34.2781, GNorm = 0.7845, lr_0 = 7.4710e-04
Loss = 2.1627e-01, PNorm = 34.2982, GNorm = 3.2380, lr_0 = 7.2871e-04
Loss = 1.8131e-01, PNorm = 34.3195, GNorm = 2.0708, lr_0 = 7.1077e-04
Validation auc = 0.840796
Validation accuracy = 0.961905
Epoch 6
Loss = 1.4468e-01, PNorm = 34.3408, GNorm = 3.4996, lr_0 = 6.9156e-04
Loss = 1.2672e-01, PNorm = 34.3591, GNorm = 0.7021, lr_0 = 6.7453e-04
Loss = 1.5150e-01, PNorm = 34.3775, GNorm = 3.0622, lr_0 = 6.5793e-04
Validation auc = 0.888336
Validation accuracy = 0.938095
Epoch 7
Loss = 1.3717e-01, PNorm = 34.3977, GNorm = 5.1141, lr_0 = 6.4174e-04
Loss = 1.4138e-01, PNorm = 34.4170, GNorm = 1.9199, lr_0 = 6.2595e-04
Loss = 1.4282e-01, PNorm = 34.4387, GNorm = 2.0234, lr_0 = 6.1054e-04
Validation auc = 0.909895
Validation accuracy = 0.938095
Epoch 8
Loss = 1.2792e-01, PNorm = 34.4599, GNorm = 7.2496, lr_0 = 5.9403e-04
Loss = 1.3809e-01, PNorm = 34.4802, GNorm = 3.4601, lr_0 = 5.7941e-04
Loss = 1.6539e-01, PNorm = 34.5018, GNorm = 0.9692, lr_0 = 5.6515e-04
Loss = 1.7880e-01, PNorm = 34.5226, GNorm = 1.6734, lr_0 = 5.5124e-04
Validation auc = 0.884467
Validation accuracy = 0.966667
Epoch 9
Loss = 1.0662e-01, PNorm = 34.5433, GNorm = 0.8815, lr_0 = 5.3767e-04
Loss = 1.3738e-01, PNorm = 34.5611, GNorm = 2.9698, lr_0 = 5.2444e-04
Loss = 1.0178e-01, PNorm = 34.5775, GNorm = 2.9979, lr_0 = 5.1153e-04
Validation auc = 0.946932
Validation accuracy = 0.957143
Epoch 10
Loss = 6.9928e-02, PNorm = 34.5920, GNorm = 0.9026, lr_0 = 4.9894e-04
Loss = 1.5239e-01, PNorm = 34.6103, GNorm = 3.5740, lr_0 = 4.8666e-04
Loss = 9.5395e-02, PNorm = 34.6281, GNorm = 2.2107, lr_0 = 4.7469e-04
Validation auc = 0.941404
Validation accuracy = 0.957143
Epoch 11
Loss = 4.7503e-02, PNorm = 34.6460, GNorm = 1.8432, lr_0 = 4.6185e-04
Loss = 9.6426e-02, PNorm = 34.6644, GNorm = 1.6362, lr_0 = 4.5048e-04
Loss = 1.2120e-01, PNorm = 34.6801, GNorm = 1.4451, lr_0 = 4.3940e-04
Loss = 1.1017e-01, PNorm = 34.6963, GNorm = 2.1875, lr_0 = 4.2858e-04
Validation auc = 0.924820
Validation accuracy = 0.961905
Epoch 12
Loss = 1.2934e-01, PNorm = 34.7129, GNorm = 4.5331, lr_0 = 4.1803e-04
Loss = 6.6405e-02, PNorm = 34.7291, GNorm = 0.8488, lr_0 = 4.0775e-04
Loss = 1.0749e-01, PNorm = 34.7433, GNorm = 0.7338, lr_0 = 3.9771e-04
Validation auc = 0.925926
Validation accuracy = 0.952381
Epoch 13
Loss = 5.5286e-02, PNorm = 34.7594, GNorm = 1.5758, lr_0 = 3.8696e-04
Loss = 1.1967e-01, PNorm = 34.7733, GNorm = 3.6591, lr_0 = 3.7743e-04
Loss = 9.5481e-02, PNorm = 34.7907, GNorm = 0.7406, lr_0 = 3.6814e-04
Loss = 8.5581e-02, PNorm = 34.8062, GNorm = 0.3778, lr_0 = 3.5908e-04
Validation auc = 0.865119
Validation accuracy = 0.966667
Epoch 14
Loss = 9.1484e-02, PNorm = 34.8177, GNorm = 1.8363, lr_0 = 3.5025e-04
Loss = 8.2612e-02, PNorm = 34.8338, GNorm = 5.3120, lr_0 = 3.4163e-04
Loss = 1.0479e-01, PNorm = 34.8457, GNorm = 1.2565, lr_0 = 3.3322e-04
Validation auc = 0.918187
Validation accuracy = 0.966667
Epoch 15
Loss = 8.8813e-02, PNorm = 34.8594, GNorm = 2.8180, lr_0 = 3.2502e-04
Loss = 8.7721e-02, PNorm = 34.8751, GNorm = 3.1101, lr_0 = 3.1702e-04
Loss = 7.4659e-02, PNorm = 34.8864, GNorm = 5.9975, lr_0 = 3.0921e-04
Validation auc = 0.911553
Validation accuracy = 0.966667
Epoch 16
Loss = 7.9452e-02, PNorm = 34.8982, GNorm = 1.9220, lr_0 = 3.0085e-04
Loss = 8.8823e-02, PNorm = 34.9091, GNorm = 1.7329, lr_0 = 2.9345e-04
Loss = 4.9792e-02, PNorm = 34.9190, GNorm = 1.4413, lr_0 = 2.8623e-04
Loss = 7.7888e-02, PNorm = 34.9305, GNorm = 1.5547, lr_0 = 2.7918e-04
Validation auc = 0.909895
Validation accuracy = 0.952381
Epoch 17
Loss = 5.3778e-02, PNorm = 34.9427, GNorm = 1.8957, lr_0 = 2.7231e-04
Loss = 7.6341e-02, PNorm = 34.9527, GNorm = 3.3199, lr_0 = 2.6561e-04
Loss = 7.8110e-02, PNorm = 34.9652, GNorm = 5.3288, lr_0 = 2.5907e-04
Validation auc = 0.943062
Validation accuracy = 0.952381
Epoch 18
Loss = 6.1809e-02, PNorm = 34.9796, GNorm = 3.5896, lr_0 = 2.5207e-04
Loss = 7.3149e-02, PNorm = 34.9915, GNorm = 0.9063, lr_0 = 2.4586e-04
Loss = 7.2577e-02, PNorm = 35.0007, GNorm = 1.7802, lr_0 = 2.3981e-04
Validation auc = 0.931454
Validation accuracy = 0.957143
Epoch 19
Loss = 4.9804e-02, PNorm = 35.0102, GNorm = 2.5949, lr_0 = 2.3391e-04
Loss = 7.3044e-02, PNorm = 35.0211, GNorm = 0.8502, lr_0 = 2.2815e-04
Loss = 8.3703e-02, PNorm = 35.0298, GNorm = 4.5243, lr_0 = 2.2254e-04
Loss = 8.1065e-02, PNorm = 35.0393, GNorm = 0.8543, lr_0 = 2.1706e-04
Validation auc = 0.888889
Validation accuracy = 0.957143
Epoch 20
Loss = 6.4905e-02, PNorm = 35.0494, GNorm = 1.1004, lr_0 = 2.1172e-04
Loss = 5.4396e-02, PNorm = 35.0599, GNorm = 0.5332, lr_0 = 2.0651e-04
Loss = 6.7545e-02, PNorm = 35.0673, GNorm = 1.4956, lr_0 = 2.0142e-04
Validation auc = 0.880044
Validation accuracy = 0.966667
Epoch 21
Loss = 8.5044e-02, PNorm = 35.0750, GNorm = 3.0233, lr_0 = 1.9598e-04
Loss = 7.7410e-02, PNorm = 35.0825, GNorm = 1.1160, lr_0 = 1.9115e-04
Loss = 6.0854e-02, PNorm = 35.0902, GNorm = 2.5831, lr_0 = 1.8645e-04
Validation auc = 0.902156
Validation accuracy = 0.971429
Epoch 22
Loss = 2.2999e-02, PNorm = 35.0985, GNorm = 1.3877, lr_0 = 1.8186e-04
Loss = 6.5030e-02, PNorm = 35.1057, GNorm = 3.7137, lr_0 = 1.7739e-04
Loss = 5.2989e-02, PNorm = 35.1145, GNorm = 2.8925, lr_0 = 1.7302e-04
Loss = 9.0931e-02, PNorm = 35.1213, GNorm = 2.6230, lr_0 = 1.6876e-04
Validation auc = 0.889442
Validation accuracy = 0.971429
Epoch 23
Loss = 5.0111e-02, PNorm = 35.1281, GNorm = 0.3801, lr_0 = 1.6420e-04
Loss = 8.4435e-02, PNorm = 35.1354, GNorm = 1.5537, lr_0 = 1.6016e-04
Loss = 4.0233e-02, PNorm = 35.1427, GNorm = 0.9687, lr_0 = 1.5622e-04
Validation auc = 0.887231
Validation accuracy = 0.961905
Epoch 24
Loss = 6.1051e-02, PNorm = 35.1479, GNorm = 1.6930, lr_0 = 1.5237e-04
Loss = 6.6292e-02, PNorm = 35.1562, GNorm = 0.6205, lr_0 = 1.4862e-04
Loss = 3.5102e-02, PNorm = 35.1633, GNorm = 1.0187, lr_0 = 1.4496e-04
Loss = 4.8825e-02, PNorm = 35.1674, GNorm = 3.3569, lr_0 = 1.4139e-04
Validation auc = 0.908237
Validation accuracy = 0.957143
Epoch 25
Loss = 5.5118e-02, PNorm = 35.1724, GNorm = 1.6437, lr_0 = 1.3791e-04
Loss = 5.4675e-02, PNorm = 35.1790, GNorm = 0.6990, lr_0 = 1.3452e-04
Loss = 5.0221e-02, PNorm = 35.1837, GNorm = 2.0896, lr_0 = 1.3121e-04
Validation auc = 0.905473
Validation accuracy = 0.961905
Epoch 26
Loss = 4.0399e-02, PNorm = 35.1905, GNorm = 0.7161, lr_0 = 1.2766e-04
Loss = 7.0363e-02, PNorm = 35.1956, GNorm = 2.5035, lr_0 = 1.2452e-04
Loss = 5.6889e-02, PNorm = 35.2045, GNorm = 2.4743, lr_0 = 1.2146e-04
Validation auc = 0.878939
Validation accuracy = 0.961905
Epoch 27
Loss = 3.3271e-02, PNorm = 35.2078, GNorm = 0.7483, lr_0 = 1.1847e-04
Loss = 4.5609e-02, PNorm = 35.2120, GNorm = 3.0945, lr_0 = 1.1555e-04
Loss = 6.2857e-02, PNorm = 35.2162, GNorm = 2.8065, lr_0 = 1.1271e-04
Loss = 3.7799e-02, PNorm = 35.2212, GNorm = 1.8156, lr_0 = 1.0993e-04
Loss = 7.5339e-02, PNorm = 35.2218, GNorm = 2.6998, lr_0 = 1.0966e-04
Validation auc = 0.891100
Validation accuracy = 0.961905
Epoch 28
Loss = 4.5739e-02, PNorm = 35.2266, GNorm = 2.2196, lr_0 = 1.0696e-04
Loss = 3.2528e-02, PNorm = 35.2303, GNorm = 0.8960, lr_0 = 1.0433e-04
Loss = 3.6768e-02, PNorm = 35.2341, GNorm = 1.2854, lr_0 = 1.0176e-04
Validation auc = 0.912106
Validation accuracy = 0.961905
Epoch 29
Loss = 3.8922e-02, PNorm = 35.2389, GNorm = 0.6063, lr_0 = 1.0000e-04
Loss = 3.2522e-02, PNorm = 35.2438, GNorm = 0.7759, lr_0 = 1.0000e-04
Loss = 4.7278e-02, PNorm = 35.2477, GNorm = 0.6543, lr_0 = 1.0000e-04
Validation auc = 0.923162
Validation accuracy = 0.957143
Model 0 best validation auc = 0.946932 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.905691
Model 0 test accuracy = 0.971564
Ensemble test auc = 0.905691
Ensemble test accuracy = 0.971564
Fold 2
Splitting data with seed 44
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 9.1731e-01, PNorm = 34.0108, GNorm = 29.9333, lr_0 = 2.5000e-04
Loss = 4.8092e-01, PNorm = 34.0127, GNorm = 11.4514, lr_0 = 3.8636e-04
Loss = 2.6387e-01, PNorm = 34.0164, GNorm = 11.4544, lr_0 = 5.2273e-04
Validation auc = 0.498401
Validation accuracy = 0.942857
Epoch 1
Loss = 3.1619e-01, PNorm = 34.0226, GNorm = 53.9083, lr_0 = 6.7273e-04
Loss = 3.3646e-01, PNorm = 34.0307, GNorm = 8.7271, lr_0 = 8.0909e-04
Loss = 2.4529e-01, PNorm = 34.0421, GNorm = 3.0068, lr_0 = 9.4545e-04
Validation auc = 0.571037
Validation accuracy = 0.947619
Epoch 2
Loss = 2.5260e-01, PNorm = 34.0595, GNorm = 9.6443, lr_0 = 9.8516e-04
Loss = 1.8083e-01, PNorm = 34.0808, GNorm = 16.0818, lr_0 = 9.6091e-04
Loss = 2.9544e-01, PNorm = 34.0990, GNorm = 12.7183, lr_0 = 9.3726e-04
Loss = 5.0283e-01, PNorm = 34.1150, GNorm = 2.4412, lr_0 = 9.1420e-04
Loss = 2.2442e-01, PNorm = 34.1169, GNorm = 6.4594, lr_0 = 9.1192e-04
Validation auc = 0.613065
Validation accuracy = 0.895238
Epoch 3
Loss = 2.6530e-01, PNorm = 34.1374, GNorm = 13.1004, lr_0 = 8.8948e-04
Loss = 2.1962e-01, PNorm = 34.1543, GNorm = 1.1641, lr_0 = 8.6758e-04
Loss = 2.1470e-01, PNorm = 34.1708, GNorm = 1.4734, lr_0 = 8.4623e-04
Validation auc = 0.594792
Validation accuracy = 0.947619
Epoch 4
Loss = 2.0932e-01, PNorm = 34.1876, GNorm = 4.3201, lr_0 = 8.2540e-04
Loss = 2.0907e-01, PNorm = 34.2065, GNorm = 0.9494, lr_0 = 8.0509e-04
Loss = 2.5842e-01, PNorm = 34.2274, GNorm = 7.6612, lr_0 = 7.8527e-04
Validation auc = 0.626313
Validation accuracy = 0.938095
Epoch 5
Loss = 2.0450e-01, PNorm = 34.2458, GNorm = 1.5437, lr_0 = 7.6595e-04
Loss = 1.5598e-01, PNorm = 34.2658, GNorm = 1.5582, lr_0 = 7.4710e-04
Loss = 1.8572e-01, PNorm = 34.2860, GNorm = 6.3135, lr_0 = 7.2871e-04
Loss = 1.6409e-01, PNorm = 34.3042, GNorm = 1.1970, lr_0 = 7.1077e-04
Validation auc = 0.619004
Validation accuracy = 0.947619
Epoch 6
Loss = 1.4610e-01, PNorm = 34.3221, GNorm = 1.9506, lr_0 = 6.9156e-04
Loss = 1.5081e-01, PNorm = 34.3421, GNorm = 3.0375, lr_0 = 6.7453e-04
Loss = 1.6974e-01, PNorm = 34.3602, GNorm = 3.0591, lr_0 = 6.5793e-04
Validation auc = 0.676565
Validation accuracy = 0.947619
Epoch 7
Loss = 1.4113e-01, PNorm = 34.3795, GNorm = 3.3591, lr_0 = 6.4174e-04
Loss = 1.4434e-01, PNorm = 34.4022, GNorm = 1.2738, lr_0 = 6.2595e-04
Loss = 1.8534e-01, PNorm = 34.4196, GNorm = 3.4519, lr_0 = 6.1054e-04
Validation auc = 0.727730
Validation accuracy = 0.957143
Epoch 8
Loss = 1.9880e-01, PNorm = 34.4408, GNorm = 1.7155, lr_0 = 5.9403e-04
Loss = 1.4878e-01, PNorm = 34.4641, GNorm = 4.8868, lr_0 = 5.7941e-04
Loss = 9.9648e-02, PNorm = 34.4859, GNorm = 1.3755, lr_0 = 5.6515e-04
Loss = 1.2781e-01, PNorm = 34.5054, GNorm = 5.1955, lr_0 = 5.5124e-04
Validation auc = 0.736866
Validation accuracy = 0.952381
Epoch 9
Loss = 8.2802e-02, PNorm = 34.5219, GNorm = 2.1597, lr_0 = 5.3767e-04
Loss = 1.8289e-01, PNorm = 34.5388, GNorm = 3.6514, lr_0 = 5.2444e-04
Loss = 1.1518e-01, PNorm = 34.5586, GNorm = 0.9095, lr_0 = 5.1153e-04
Validation auc = 0.761535
Validation accuracy = 0.957143
Epoch 10
Loss = 1.2935e-01, PNorm = 34.5775, GNorm = 1.4979, lr_0 = 4.9894e-04
Loss = 1.0101e-01, PNorm = 34.5958, GNorm = 1.4654, lr_0 = 4.8666e-04
Loss = 9.9613e-02, PNorm = 34.6127, GNorm = 3.9941, lr_0 = 4.7469e-04
Validation auc = 0.726816
Validation accuracy = 0.952381
Epoch 11
Loss = 6.5431e-02, PNorm = 34.6318, GNorm = 1.4305, lr_0 = 4.6185e-04
Loss = 1.1733e-01, PNorm = 34.6511, GNorm = 5.2223, lr_0 = 4.5048e-04
Loss = 1.1788e-01, PNorm = 34.6730, GNorm = 1.2435, lr_0 = 4.3940e-04
Loss = 1.2432e-01, PNorm = 34.6931, GNorm = 0.5130, lr_0 = 4.2858e-04
Validation auc = 0.779808
Validation accuracy = 0.947619
Epoch 12
Loss = 8.7069e-02, PNorm = 34.7090, GNorm = 1.6747, lr_0 = 4.1803e-04
Loss = 8.9940e-02, PNorm = 34.7259, GNorm = 0.5977, lr_0 = 4.0775e-04
Loss = 1.2818e-01, PNorm = 34.7428, GNorm = 2.4892, lr_0 = 3.9771e-04
Validation auc = 0.783463
Validation accuracy = 0.952381
Epoch 13
Loss = 8.7534e-02, PNorm = 34.7599, GNorm = 2.2994, lr_0 = 3.8696e-04
Loss = 7.0253e-02, PNorm = 34.7757, GNorm = 1.4179, lr_0 = 3.7743e-04
Loss = 1.3055e-01, PNorm = 34.7887, GNorm = 1.6104, lr_0 = 3.6814e-04
Loss = 8.9928e-02, PNorm = 34.8029, GNorm = 4.9941, lr_0 = 3.5908e-04
Validation auc = 0.783920
Validation accuracy = 0.957143
Epoch 14
Loss = 7.3364e-02, PNorm = 34.8161, GNorm = 3.0438, lr_0 = 3.5025e-04
Loss = 7.9995e-02, PNorm = 34.8321, GNorm = 1.8186, lr_0 = 3.4163e-04
Loss = 8.4975e-02, PNorm = 34.8470, GNorm = 1.1623, lr_0 = 3.3322e-04
Validation auc = 0.770672
Validation accuracy = 0.952381
Epoch 15
Loss = 6.6900e-02, PNorm = 34.8586, GNorm = 1.9510, lr_0 = 3.2502e-04
Loss = 4.9251e-02, PNorm = 34.8685, GNorm = 2.9162, lr_0 = 3.1702e-04
Loss = 9.4371e-02, PNorm = 34.8790, GNorm = 1.7270, lr_0 = 3.0921e-04
Validation auc = 0.742805
Validation accuracy = 0.933333
Epoch 16
Loss = 1.4442e-01, PNorm = 34.8941, GNorm = 1.0442, lr_0 = 3.0085e-04
Loss = 6.1663e-02, PNorm = 34.9085, GNorm = 0.9117, lr_0 = 2.9345e-04
Loss = 7.8060e-02, PNorm = 34.9202, GNorm = 0.7016, lr_0 = 2.8623e-04
Loss = 7.7779e-02, PNorm = 34.9315, GNorm = 1.2792, lr_0 = 2.7918e-04
Validation auc = 0.768387
Validation accuracy = 0.947619
Epoch 17
Loss = 8.7797e-02, PNorm = 34.9438, GNorm = 0.9020, lr_0 = 2.7231e-04
Loss = 9.7504e-02, PNorm = 34.9553, GNorm = 1.3685, lr_0 = 2.6561e-04
Loss = 6.0325e-02, PNorm = 34.9648, GNorm = 1.1307, lr_0 = 2.5907e-04
Validation auc = 0.802650
Validation accuracy = 0.966667
Epoch 18
Loss = 5.8822e-02, PNorm = 34.9753, GNorm = 1.6232, lr_0 = 2.5207e-04
Loss = 7.2550e-02, PNorm = 34.9843, GNorm = 0.7554, lr_0 = 2.4586e-04
Loss = 7.5114e-02, PNorm = 34.9938, GNorm = 3.3011, lr_0 = 2.3981e-04
Validation auc = 0.779808
Validation accuracy = 0.957143
Epoch 19
Loss = 2.2227e-02, PNorm = 35.0039, GNorm = 0.5822, lr_0 = 2.3391e-04
Loss = 7.1491e-02, PNorm = 35.0138, GNorm = 2.3698, lr_0 = 2.2815e-04
Loss = 6.6803e-02, PNorm = 35.0233, GNorm = 0.7092, lr_0 = 2.2254e-04
Loss = 6.1513e-02, PNorm = 35.0328, GNorm = 1.8021, lr_0 = 2.1706e-04
Validation auc = 0.767931
Validation accuracy = 0.966667
Epoch 20
Loss = 6.6618e-02, PNorm = 35.0397, GNorm = 1.2020, lr_0 = 2.1172e-04
Loss = 6.2830e-02, PNorm = 35.0489, GNorm = 3.4727, lr_0 = 2.0651e-04
Loss = 6.7381e-02, PNorm = 35.0557, GNorm = 0.6556, lr_0 = 2.0142e-04
Validation auc = 0.796711
Validation accuracy = 0.961905
Epoch 21
Loss = 5.8700e-02, PNorm = 35.0660, GNorm = 0.7737, lr_0 = 1.9598e-04
Loss = 4.7222e-02, PNorm = 35.0748, GNorm = 0.4939, lr_0 = 1.9115e-04
Loss = 7.4580e-02, PNorm = 35.0815, GNorm = 3.1608, lr_0 = 1.8645e-04
Validation auc = 0.789402
Validation accuracy = 0.961905
Epoch 22
Loss = 1.4296e-01, PNorm = 35.0901, GNorm = 2.3908, lr_0 = 1.8186e-04
Loss = 7.4783e-02, PNorm = 35.0971, GNorm = 3.9946, lr_0 = 1.7739e-04
Loss = 4.5046e-02, PNorm = 35.1059, GNorm = 3.5078, lr_0 = 1.7302e-04
Loss = 5.8980e-02, PNorm = 35.1116, GNorm = 1.1484, lr_0 = 1.6876e-04
Validation auc = 0.787117
Validation accuracy = 0.938095
Epoch 23
Loss = 5.7840e-02, PNorm = 35.1199, GNorm = 1.4958, lr_0 = 1.6420e-04
Loss = 6.7506e-02, PNorm = 35.1262, GNorm = 2.1841, lr_0 = 1.6016e-04
Loss = 5.7099e-02, PNorm = 35.1346, GNorm = 0.4410, lr_0 = 1.5622e-04
Validation auc = 0.752398
Validation accuracy = 0.961905
Epoch 24
Loss = 9.3847e-02, PNorm = 35.1397, GNorm = 2.0964, lr_0 = 1.5237e-04
Loss = 6.0014e-02, PNorm = 35.1453, GNorm = 1.3111, lr_0 = 1.4862e-04
Loss = 5.5262e-02, PNorm = 35.1513, GNorm = 1.1833, lr_0 = 1.4496e-04
Loss = 4.5602e-02, PNorm = 35.1574, GNorm = 1.0596, lr_0 = 1.4139e-04
Validation auc = 0.792599
Validation accuracy = 0.961905
Epoch 25
Loss = 4.8740e-02, PNorm = 35.1629, GNorm = 2.8600, lr_0 = 1.3791e-04
Loss = 5.7968e-02, PNorm = 35.1698, GNorm = 1.9298, lr_0 = 1.3452e-04
Loss = 4.2069e-02, PNorm = 35.1751, GNorm = 1.3802, lr_0 = 1.3121e-04
Validation auc = 0.782549
Validation accuracy = 0.961905
Epoch 26
Loss = 4.4701e-02, PNorm = 35.1804, GNorm = 0.7131, lr_0 = 1.2766e-04
Loss = 5.5532e-02, PNorm = 35.1854, GNorm = 0.4913, lr_0 = 1.2452e-04
Loss = 4.9675e-02, PNorm = 35.1904, GNorm = 0.6541, lr_0 = 1.2146e-04
Validation auc = 0.797168
Validation accuracy = 0.957143
Epoch 27
Loss = 3.3453e-02, PNorm = 35.1946, GNorm = 1.2460, lr_0 = 1.1847e-04
Loss = 5.6138e-02, PNorm = 35.2002, GNorm = 0.5465, lr_0 = 1.1555e-04
Loss = 4.6244e-02, PNorm = 35.2058, GNorm = 2.0658, lr_0 = 1.1271e-04
Loss = 4.4886e-02, PNorm = 35.2100, GNorm = 1.0229, lr_0 = 1.0993e-04
Loss = 1.4256e-01, PNorm = 35.2105, GNorm = 3.2878, lr_0 = 1.0966e-04
Validation auc = 0.791686
Validation accuracy = 0.961905
Epoch 28
Loss = 5.7680e-02, PNorm = 35.2144, GNorm = 0.8362, lr_0 = 1.0696e-04
Loss = 4.7346e-02, PNorm = 35.2195, GNorm = 0.7802, lr_0 = 1.0433e-04
Loss = 4.5565e-02, PNorm = 35.2241, GNorm = 0.5301, lr_0 = 1.0176e-04
Validation auc = 0.787117
Validation accuracy = 0.952381
Epoch 29
Loss = 2.8468e-02, PNorm = 35.2284, GNorm = 0.5973, lr_0 = 1.0000e-04
Loss = 4.4195e-02, PNorm = 35.2314, GNorm = 1.6731, lr_0 = 1.0000e-04
Loss = 4.5731e-02, PNorm = 35.2348, GNorm = 1.8455, lr_0 = 1.0000e-04
Validation auc = 0.797624
Validation accuracy = 0.952381
Model 0 best validation auc = 0.802650 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.843902
Model 0 test accuracy = 0.976303
Ensemble test auc = 0.843902
Ensemble test accuracy = 0.976303
3-fold cross validation
	Seed 42 ==> test auc = 0.960591
	Seed 42 ==> test accuracy = 0.976303
	Seed 43 ==> test auc = 0.905691
	Seed 43 ==> test accuracy = 0.971564
	Seed 44 ==> test auc = 0.843902
	Seed 44 ==> test accuracy = 0.976303
Overall test auc = 0.903395 +/- 0.047666
Overall test accuracy = 0.974724 +/- 0.002234
Elapsed time = 0:07:24
Command line
python /Users/anastasiakuznecova/PycharmProjects/chemprop-master/Testing Chemprop for project.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'sum',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'tests/data/Halicin_train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'classification_checkpoints/sum/exp1/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Could not write the reproducibility section of the arguments to file, thus omitting this section.
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 5.7000e-01, PNorm = 34.0104, GNorm = 5.4840, lr_0 = 2.5000e-04
