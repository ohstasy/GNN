Command line
python /Users/anastasiakuznecova/PycharmProjects/chemprop-master/Testing Chemprop for project.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'tests/data/Halicin_train.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 3,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'classification_checkpoints/mean/exp1/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['Smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['Active'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Could not write the reproducibility section of the arguments to file, thus omitting this section.
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 3.9275e-01, PNorm = 34.0190, GNorm = 0.4286, lr_0 = 2.5000e-04
Loss = 1.7442e-01, PNorm = 34.0342, GNorm = 0.9440, lr_0 = 3.8636e-04
Loss = 2.9335e-01, PNorm = 34.0335, GNorm = 0.7836, lr_0 = 5.2273e-04
Validation auc = 0.479658
Validation accuracy = 0.928571
Epoch 1
Loss = 2.0694e-01, PNorm = 34.0511, GNorm = 0.4793, lr_0 = 6.7273e-04
Loss = 2.3519e-01, PNorm = 34.0627, GNorm = 0.8897, lr_0 = 8.0909e-04
Loss = 2.1901e-01, PNorm = 34.0829, GNorm = 0.4668, lr_0 = 9.4545e-04
Validation auc = 0.603761
Validation accuracy = 0.928571
Epoch 2
Loss = 3.3312e-01, PNorm = 34.1043, GNorm = 1.0227, lr_0 = 9.8516e-04
Loss = 2.2075e-01, PNorm = 34.1233, GNorm = 0.1725, lr_0 = 9.6091e-04
Loss = 1.8933e-01, PNorm = 34.1512, GNorm = 0.7211, lr_0 = 9.3726e-04
Loss = 1.6974e-01, PNorm = 34.1700, GNorm = 0.2392, lr_0 = 9.1420e-04
Loss = 1.5833e-01, PNorm = 34.1746, GNorm = 0.2224, lr_0 = 9.1192e-04
Validation auc = 0.764444
Validation accuracy = 0.928571
Epoch 3
Loss = 2.1126e-01, PNorm = 34.2046, GNorm = 0.3137, lr_0 = 8.8948e-04
Loss = 2.1466e-01, PNorm = 34.2324, GNorm = 0.2911, lr_0 = 8.6758e-04
Loss = 1.5606e-01, PNorm = 34.2707, GNorm = 0.2268, lr_0 = 8.4623e-04
Validation auc = 0.829744
Validation accuracy = 0.928571
Epoch 4
Loss = 2.1426e-01, PNorm = 34.2869, GNorm = 0.3208, lr_0 = 8.2540e-04
Loss = 1.8814e-01, PNorm = 34.3287, GNorm = 0.2033, lr_0 = 8.0509e-04
Loss = 1.6259e-01, PNorm = 34.3588, GNorm = 0.2756, lr_0 = 7.8527e-04
Validation auc = 0.879316
Validation accuracy = 0.928571
Epoch 5
Loss = 1.5813e-01, PNorm = 34.3925, GNorm = 0.1970, lr_0 = 7.6595e-04
Loss = 1.7566e-01, PNorm = 34.4454, GNorm = 0.2975, lr_0 = 7.4710e-04
Loss = 1.8301e-01, PNorm = 34.5012, GNorm = 0.2490, lr_0 = 7.2871e-04
Loss = 1.8656e-01, PNorm = 34.5388, GNorm = 0.3799, lr_0 = 7.1077e-04
Validation auc = 0.888547
Validation accuracy = 0.928571
Epoch 6
Loss = 1.7706e-01, PNorm = 34.5984, GNorm = 0.3329, lr_0 = 6.9156e-04
Loss = 1.5244e-01, PNorm = 34.6659, GNorm = 0.2460, lr_0 = 6.7453e-04
Loss = 1.9635e-01, PNorm = 34.7134, GNorm = 0.5213, lr_0 = 6.5793e-04
Validation auc = 0.897778
Validation accuracy = 0.928571
Epoch 7
Loss = 1.7373e-01, PNorm = 34.7709, GNorm = 0.4601, lr_0 = 6.4174e-04
Loss = 1.4945e-01, PNorm = 34.8107, GNorm = 0.1762, lr_0 = 6.2595e-04
Loss = 1.8348e-01, PNorm = 34.8547, GNorm = 0.2725, lr_0 = 6.1054e-04
Validation auc = 0.913504
Validation accuracy = 0.928571
Epoch 8
Loss = 1.5542e-01, PNorm = 34.9213, GNorm = 0.2052, lr_0 = 5.9403e-04
Loss = 1.3075e-01, PNorm = 34.9921, GNorm = 0.2720, lr_0 = 5.7941e-04
Loss = 1.5751e-01, PNorm = 35.0518, GNorm = 0.6830, lr_0 = 5.6515e-04
Loss = 1.6114e-01, PNorm = 35.1140, GNorm = 0.2711, lr_0 = 5.5124e-04
Validation auc = 0.921709
Validation accuracy = 0.933333
Epoch 9
Loss = 1.3452e-01, PNorm = 35.1727, GNorm = 0.2714, lr_0 = 5.3767e-04
Loss = 1.7418e-01, PNorm = 35.2398, GNorm = 0.4454, lr_0 = 5.2444e-04
Loss = 1.3267e-01, PNorm = 35.3136, GNorm = 0.3675, lr_0 = 5.1153e-04
Validation auc = 0.920000
Validation accuracy = 0.947619
Epoch 10
Loss = 1.1122e-01, PNorm = 35.3656, GNorm = 0.2305, lr_0 = 4.9894e-04
Loss = 1.7045e-01, PNorm = 35.4068, GNorm = 0.2161, lr_0 = 4.8666e-04
Loss = 1.4889e-01, PNorm = 35.4691, GNorm = 0.4430, lr_0 = 4.7469e-04
Validation auc = 0.927179
Validation accuracy = 0.952381
Epoch 11
Loss = 2.8924e-01, PNorm = 35.5366, GNorm = 0.8228, lr_0 = 4.6185e-04
Loss = 1.1263e-01, PNorm = 35.6195, GNorm = 0.3313, lr_0 = 4.5048e-04
Loss = 1.1895e-01, PNorm = 35.6722, GNorm = 0.5401, lr_0 = 4.3940e-04
Loss = 1.5512e-01, PNorm = 35.7083, GNorm = 0.7799, lr_0 = 4.2858e-04
Validation auc = 0.913846
Validation accuracy = 0.957143
Epoch 12
Loss = 1.2807e-01, PNorm = 35.7618, GNorm = 0.3200, lr_0 = 4.1803e-04
Loss = 1.3213e-01, PNorm = 35.8111, GNorm = 0.6773, lr_0 = 4.0775e-04
Loss = 1.0941e-01, PNorm = 35.8613, GNorm = 0.1552, lr_0 = 3.9771e-04
Validation auc = 0.885470
Validation accuracy = 0.957143
Epoch 13
Loss = 9.4745e-02, PNorm = 35.9021, GNorm = 0.4044, lr_0 = 3.8696e-04
Loss = 1.5442e-01, PNorm = 35.9377, GNorm = 0.5688, lr_0 = 3.7743e-04
Loss = 1.0031e-01, PNorm = 35.9879, GNorm = 0.1531, lr_0 = 3.6814e-04
Loss = 1.4269e-01, PNorm = 36.0173, GNorm = 0.3311, lr_0 = 3.5908e-04
Validation auc = 0.900171
Validation accuracy = 0.957143
Epoch 14
Loss = 1.2838e-01, PNorm = 36.0649, GNorm = 0.4295, lr_0 = 3.5025e-04
Loss = 1.5450e-01, PNorm = 36.1034, GNorm = 0.3932, lr_0 = 3.4163e-04
Loss = 7.3408e-02, PNorm = 36.1311, GNorm = 0.2066, lr_0 = 3.3322e-04
Validation auc = 0.885812
Validation accuracy = 0.957143
Epoch 15
Loss = 1.0532e-01, PNorm = 36.1628, GNorm = 1.2064, lr_0 = 3.2502e-04
Loss = 1.3831e-01, PNorm = 36.2010, GNorm = 0.3329, lr_0 = 3.1702e-04
Loss = 9.8843e-02, PNorm = 36.2334, GNorm = 0.7826, lr_0 = 3.0921e-04
Validation auc = 0.884786
Validation accuracy = 0.952381
Epoch 16
Loss = 1.0840e-01, PNorm = 36.2690, GNorm = 0.8221, lr_0 = 3.0085e-04
Loss = 1.1818e-01, PNorm = 36.2928, GNorm = 0.7595, lr_0 = 2.9345e-04
Loss = 8.7650e-02, PNorm = 36.3306, GNorm = 1.4344, lr_0 = 2.8623e-04
Loss = 1.3910e-01, PNorm = 36.3496, GNorm = 0.6976, lr_0 = 2.7918e-04
Validation auc = 0.909744
Validation accuracy = 0.957143
Epoch 17
Loss = 8.5257e-02, PNorm = 36.3764, GNorm = 0.1528, lr_0 = 2.7231e-04
Loss = 1.1602e-01, PNorm = 36.4009, GNorm = 0.8827, lr_0 = 2.6561e-04
Loss = 1.1584e-01, PNorm = 36.4291, GNorm = 0.5944, lr_0 = 2.5907e-04
Validation auc = 0.902906
Validation accuracy = 0.957143
Epoch 18
Loss = 1.0516e-01, PNorm = 36.4538, GNorm = 0.2765, lr_0 = 2.5207e-04
Loss = 1.1658e-01, PNorm = 36.4774, GNorm = 0.2895, lr_0 = 2.4586e-04
Loss = 1.1126e-01, PNorm = 36.5016, GNorm = 0.5963, lr_0 = 2.3981e-04
Validation auc = 0.891966
Validation accuracy = 0.961905
Epoch 19
Loss = 5.4652e-02, PNorm = 36.5271, GNorm = 0.5416, lr_0 = 2.3391e-04
Loss = 1.1853e-01, PNorm = 36.5540, GNorm = 0.4366, lr_0 = 2.2815e-04
Loss = 9.1800e-02, PNorm = 36.5777, GNorm = 0.2704, lr_0 = 2.2254e-04
Loss = 9.7313e-02, PNorm = 36.5897, GNorm = 0.4374, lr_0 = 2.1706e-04
Validation auc = 0.894359
Validation accuracy = 0.947619
Epoch 20
Loss = 8.3005e-02, PNorm = 36.6140, GNorm = 0.4914, lr_0 = 2.1172e-04
Loss = 1.1660e-01, PNorm = 36.6353, GNorm = 0.9741, lr_0 = 2.0651e-04
Loss = 8.9622e-02, PNorm = 36.6534, GNorm = 1.5947, lr_0 = 2.0142e-04
Validation auc = 0.877265
Validation accuracy = 0.966667
Epoch 21
Loss = 1.2665e-01, PNorm = 36.6688, GNorm = 0.8197, lr_0 = 1.9598e-04
Loss = 1.0922e-01, PNorm = 36.6961, GNorm = 0.5722, lr_0 = 1.9115e-04
Loss = 8.6763e-02, PNorm = 36.7120, GNorm = 0.4133, lr_0 = 1.8645e-04
Validation auc = 0.890940
Validation accuracy = 0.966667
Epoch 22
Loss = 2.5428e-02, PNorm = 36.7265, GNorm = 0.1848, lr_0 = 1.8186e-04
Loss = 7.4557e-02, PNorm = 36.7420, GNorm = 0.3548, lr_0 = 1.7739e-04
Loss = 7.3989e-02, PNorm = 36.7561, GNorm = 0.2736, lr_0 = 1.7302e-04
Loss = 1.1759e-01, PNorm = 36.7740, GNorm = 0.6301, lr_0 = 1.6876e-04
Validation auc = 0.888889
Validation accuracy = 0.957143
Epoch 23
Loss = 5.4110e-02, PNorm = 36.7932, GNorm = 0.2357, lr_0 = 1.6420e-04
Loss = 1.0675e-01, PNorm = 36.8044, GNorm = 0.3074, lr_0 = 1.6016e-04
Loss = 9.8677e-02, PNorm = 36.8184, GNorm = 0.5728, lr_0 = 1.5622e-04
Validation auc = 0.884103
Validation accuracy = 0.961905
Epoch 24
Loss = 6.6802e-02, PNorm = 36.8337, GNorm = 0.5177, lr_0 = 1.5237e-04
Loss = 9.3386e-02, PNorm = 36.8495, GNorm = 0.8613, lr_0 = 1.4862e-04
Loss = 7.9564e-02, PNorm = 36.8605, GNorm = 0.4017, lr_0 = 1.4496e-04
Loss = 1.0083e-01, PNorm = 36.8730, GNorm = 1.0795, lr_0 = 1.4139e-04
Validation auc = 0.895043
Validation accuracy = 0.952381
Epoch 25
Loss = 8.9711e-02, PNorm = 36.8916, GNorm = 0.3757, lr_0 = 1.3791e-04
Loss = 7.1206e-02, PNorm = 36.9071, GNorm = 0.5624, lr_0 = 1.3452e-04
Loss = 1.0268e-01, PNorm = 36.9168, GNorm = 0.5463, lr_0 = 1.3121e-04
Validation auc = 0.890598
Validation accuracy = 0.952381
Epoch 26
Loss = 9.8551e-02, PNorm = 36.9309, GNorm = 0.7331, lr_0 = 1.2766e-04
Loss = 7.4885e-02, PNorm = 36.9440, GNorm = 0.4541, lr_0 = 1.2452e-04
Loss = 7.9676e-02, PNorm = 36.9576, GNorm = 0.5926, lr_0 = 1.2146e-04
Validation auc = 0.884786
Validation accuracy = 0.961905
Epoch 27
Loss = 5.6528e-02, PNorm = 36.9636, GNorm = 0.3003, lr_0 = 1.1847e-04
Loss = 9.6578e-02, PNorm = 36.9720, GNorm = 0.6626, lr_0 = 1.1555e-04
Loss = 8.6006e-02, PNorm = 36.9820, GNorm = 0.7097, lr_0 = 1.1271e-04
Loss = 7.0422e-02, PNorm = 36.9915, GNorm = 0.6434, lr_0 = 1.0993e-04
Loss = 5.1726e-02, PNorm = 36.9924, GNorm = 0.7779, lr_0 = 1.0966e-04
Validation auc = 0.890256
Validation accuracy = 0.957143
Epoch 28
Loss = 7.3896e-02, PNorm = 37.0026, GNorm = 0.6537, lr_0 = 1.0696e-04
Loss = 9.8696e-02, PNorm = 37.0116, GNorm = 0.7418, lr_0 = 1.0433e-04
Loss = 7.3444e-02, PNorm = 37.0244, GNorm = 0.5777, lr_0 = 1.0176e-04
Validation auc = 0.884786
Validation accuracy = 0.961905
Epoch 29
Loss = 1.2398e-01, PNorm = 37.0313, GNorm = 0.7328, lr_0 = 1.0000e-04
Loss = 7.5518e-02, PNorm = 37.0445, GNorm = 0.4006, lr_0 = 1.0000e-04
Loss = 6.0214e-02, PNorm = 37.0549, GNorm = 0.4889, lr_0 = 1.0000e-04
Validation auc = 0.891966
Validation accuracy = 0.957143
Model 0 best validation auc = 0.927179 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.978448
Model 0 test accuracy = 0.976303
Ensemble test auc = 0.978448
Ensemble test accuracy = 0.976303
Fold 1
Splitting data with seed 43
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 4.0272e-01, PNorm = 34.0189, GNorm = 0.4854, lr_0 = 2.5000e-04
Loss = 2.1990e-01, PNorm = 34.0315, GNorm = 0.1549, lr_0 = 3.8636e-04
Loss = 2.3014e-01, PNorm = 34.0359, GNorm = 0.4823, lr_0 = 5.2273e-04
Validation auc = 0.517413
Validation accuracy = 0.957143
Epoch 1
Loss = 2.0129e-01, PNorm = 34.0544, GNorm = 0.3133, lr_0 = 6.7273e-04
Loss = 2.0323e-01, PNorm = 34.0712, GNorm = 0.1787, lr_0 = 8.0909e-04
Loss = 2.1444e-01, PNorm = 34.0965, GNorm = 0.1968, lr_0 = 9.4545e-04
Validation auc = 0.749033
Validation accuracy = 0.957143
Epoch 2
Loss = 1.5139e-01, PNorm = 34.1341, GNorm = 0.5532, lr_0 = 9.8516e-04
Loss = 1.4969e-01, PNorm = 34.1789, GNorm = 0.8649, lr_0 = 9.6091e-04
Loss = 2.2902e-01, PNorm = 34.2183, GNorm = 0.3437, lr_0 = 9.3726e-04
Loss = 2.3696e-01, PNorm = 34.2387, GNorm = 0.4510, lr_0 = 9.1420e-04
Loss = 2.3258e-01, PNorm = 34.2434, GNorm = 0.3189, lr_0 = 9.1192e-04
Validation auc = 0.757324
Validation accuracy = 0.957143
Epoch 3
Loss = 1.7940e-01, PNorm = 34.2874, GNorm = 0.1258, lr_0 = 8.8948e-04
Loss = 2.0309e-01, PNorm = 34.3163, GNorm = 0.4200, lr_0 = 8.6758e-04
Loss = 1.7984e-01, PNorm = 34.3653, GNorm = 0.1388, lr_0 = 8.4623e-04
Validation auc = 0.757877
Validation accuracy = 0.957143
Epoch 4
Loss = 1.7504e-01, PNorm = 34.4080, GNorm = 0.2386, lr_0 = 8.2540e-04
Loss = 1.6533e-01, PNorm = 34.4665, GNorm = 0.3053, lr_0 = 8.0509e-04
Loss = 2.0673e-01, PNorm = 34.5001, GNorm = 1.9969, lr_0 = 7.8527e-04
Validation auc = 0.762300
Validation accuracy = 0.957143
Epoch 5
Loss = 2.4161e-01, PNorm = 34.5434, GNorm = 0.5152, lr_0 = 7.6595e-04
Loss = 1.4576e-01, PNorm = 34.5886, GNorm = 0.2898, lr_0 = 7.4710e-04
Loss = 1.9247e-01, PNorm = 34.6377, GNorm = 0.2564, lr_0 = 7.2871e-04
Loss = 2.0079e-01, PNorm = 34.6719, GNorm = 0.2669, lr_0 = 7.1077e-04
Validation auc = 0.822554
Validation accuracy = 0.957143
Epoch 6
Loss = 1.6721e-01, PNorm = 34.7283, GNorm = 0.6557, lr_0 = 6.9156e-04
Loss = 1.4463e-01, PNorm = 34.7750, GNorm = 0.1833, lr_0 = 6.7453e-04
Loss = 1.7786e-01, PNorm = 34.8281, GNorm = 0.1740, lr_0 = 6.5793e-04
Validation auc = 0.835268
Validation accuracy = 0.957143
Epoch 7
Loss = 1.7550e-01, PNorm = 34.8647, GNorm = 0.2147, lr_0 = 6.4174e-04
Loss = 1.7380e-01, PNorm = 34.9115, GNorm = 0.3385, lr_0 = 6.2595e-04
Loss = 1.4000e-01, PNorm = 34.9716, GNorm = 0.5848, lr_0 = 6.1054e-04
Validation auc = 0.850193
Validation accuracy = 0.947619
Epoch 8
Loss = 1.5105e-01, PNorm = 35.0292, GNorm = 0.2291, lr_0 = 5.9403e-04
Loss = 1.3997e-01, PNorm = 35.0858, GNorm = 0.3990, lr_0 = 5.7941e-04
Loss = 1.4012e-01, PNorm = 35.1460, GNorm = 0.2767, lr_0 = 5.6515e-04
Loss = 1.8995e-01, PNorm = 35.1899, GNorm = 0.5314, lr_0 = 5.5124e-04
Validation auc = 0.843007
Validation accuracy = 0.952381
Epoch 9
Loss = 1.3638e-01, PNorm = 35.2433, GNorm = 0.2461, lr_0 = 5.3767e-04
Loss = 1.5230e-01, PNorm = 35.3048, GNorm = 0.5756, lr_0 = 5.2444e-04
Loss = 1.2650e-01, PNorm = 35.3563, GNorm = 0.6274, lr_0 = 5.1153e-04
Validation auc = 0.871200
Validation accuracy = 0.942857
Epoch 10
Loss = 1.1575e-01, PNorm = 35.4018, GNorm = 0.8328, lr_0 = 4.9894e-04
Loss = 1.9527e-01, PNorm = 35.4643, GNorm = 0.5429, lr_0 = 4.8666e-04
Loss = 1.0957e-01, PNorm = 35.5264, GNorm = 0.2689, lr_0 = 4.7469e-04
Validation auc = 0.874516
Validation accuracy = 0.938095
Epoch 11
Loss = 8.5203e-02, PNorm = 35.5746, GNorm = 1.0272, lr_0 = 4.6185e-04
Loss = 1.1585e-01, PNorm = 35.6283, GNorm = 0.2627, lr_0 = 4.5048e-04
Loss = 1.4779e-01, PNorm = 35.6668, GNorm = 0.7871, lr_0 = 4.3940e-04
Loss = 1.4532e-01, PNorm = 35.7146, GNorm = 0.6621, lr_0 = 4.2858e-04
Validation auc = 0.898286
Validation accuracy = 0.947619
Epoch 12
Loss = 1.6163e-01, PNorm = 35.7645, GNorm = 0.6014, lr_0 = 4.1803e-04
Loss = 9.3155e-02, PNorm = 35.8049, GNorm = 0.2636, lr_0 = 4.0775e-04
Loss = 1.2883e-01, PNorm = 35.8535, GNorm = 0.2217, lr_0 = 3.9771e-04
Validation auc = 0.897734
Validation accuracy = 0.947619
Epoch 13
Loss = 7.2198e-02, PNorm = 35.9083, GNorm = 0.6903, lr_0 = 3.8696e-04
Loss = 1.5299e-01, PNorm = 35.9484, GNorm = 0.9424, lr_0 = 3.7743e-04
Loss = 1.3923e-01, PNorm = 35.9906, GNorm = 0.4272, lr_0 = 3.6814e-04
Loss = 1.0228e-01, PNorm = 36.0268, GNorm = 0.1641, lr_0 = 3.5908e-04
Validation auc = 0.925373
Validation accuracy = 0.961905
Epoch 14
Loss = 1.3341e-01, PNorm = 36.0551, GNorm = 1.0356, lr_0 = 3.5025e-04
Loss = 9.5141e-02, PNorm = 36.0962, GNorm = 1.1524, lr_0 = 3.4163e-04
Loss = 1.4987e-01, PNorm = 36.1178, GNorm = 0.9688, lr_0 = 3.3322e-04
Validation auc = 0.912659
Validation accuracy = 0.961905
Epoch 15
Loss = 1.1589e-01, PNorm = 36.1555, GNorm = 0.2374, lr_0 = 3.2502e-04
Loss = 1.3726e-01, PNorm = 36.1952, GNorm = 1.2905, lr_0 = 3.1702e-04
Loss = 1.0397e-01, PNorm = 36.2215, GNorm = 0.5837, lr_0 = 3.0921e-04
Validation auc = 0.927584
Validation accuracy = 0.947619
Epoch 16
Loss = 8.5966e-02, PNorm = 36.2509, GNorm = 0.4826, lr_0 = 3.0085e-04
Loss = 1.2068e-01, PNorm = 36.2803, GNorm = 0.3775, lr_0 = 2.9345e-04
Loss = 8.5115e-02, PNorm = 36.3050, GNorm = 0.4559, lr_0 = 2.8623e-04
Loss = 1.2027e-01, PNorm = 36.3335, GNorm = 0.5548, lr_0 = 2.7918e-04
Validation auc = 0.927584
Validation accuracy = 0.952381
Epoch 17
Loss = 8.1031e-02, PNorm = 36.3688, GNorm = 1.1089, lr_0 = 2.7231e-04
Loss = 1.1038e-01, PNorm = 36.3905, GNorm = 1.1140, lr_0 = 2.6561e-04
Loss = 1.0659e-01, PNorm = 36.4163, GNorm = 0.8684, lr_0 = 2.5907e-04
Validation auc = 0.943615
Validation accuracy = 0.952381
Epoch 18
Loss = 1.0818e-01, PNorm = 36.4375, GNorm = 0.9958, lr_0 = 2.5207e-04
Loss = 9.6981e-02, PNorm = 36.4721, GNorm = 0.3413, lr_0 = 2.4586e-04
Loss = 1.0723e-01, PNorm = 36.4937, GNorm = 0.7118, lr_0 = 2.3981e-04
Validation auc = 0.965727
Validation accuracy = 0.961905
Epoch 19
Loss = 7.1290e-02, PNorm = 36.5178, GNorm = 0.3953, lr_0 = 2.3391e-04
Loss = 1.4317e-01, PNorm = 36.5281, GNorm = 0.7242, lr_0 = 2.2815e-04
Loss = 8.7109e-02, PNorm = 36.5551, GNorm = 0.5628, lr_0 = 2.2254e-04
Loss = 1.1282e-01, PNorm = 36.5734, GNorm = 0.4388, lr_0 = 2.1706e-04
Validation auc = 0.945826
Validation accuracy = 0.952381
Epoch 20
Loss = 1.1100e-01, PNorm = 36.5973, GNorm = 1.6342, lr_0 = 2.1172e-04
Loss = 8.7572e-02, PNorm = 36.6199, GNorm = 0.2022, lr_0 = 2.0651e-04
Loss = 1.0853e-01, PNorm = 36.6341, GNorm = 0.7885, lr_0 = 2.0142e-04
Validation auc = 0.938640
Validation accuracy = 0.952381
Epoch 21
Loss = 1.1324e-01, PNorm = 36.6537, GNorm = 0.7019, lr_0 = 1.9598e-04
Loss = 1.2559e-01, PNorm = 36.6730, GNorm = 0.3342, lr_0 = 1.9115e-04
Loss = 8.3934e-02, PNorm = 36.6932, GNorm = 0.9014, lr_0 = 1.8645e-04
Validation auc = 0.968491
Validation accuracy = 0.961905
Epoch 22
Loss = 8.8999e-02, PNorm = 36.7130, GNorm = 0.9438, lr_0 = 1.8186e-04
Loss = 8.4731e-02, PNorm = 36.7271, GNorm = 1.0143, lr_0 = 1.7739e-04
Loss = 8.3276e-02, PNorm = 36.7455, GNorm = 1.6725, lr_0 = 1.7302e-04
Loss = 1.2901e-01, PNorm = 36.7583, GNorm = 1.5872, lr_0 = 1.6876e-04
Validation auc = 0.964621
Validation accuracy = 0.961905
Epoch 23
Loss = 8.2733e-02, PNorm = 36.7719, GNorm = 0.2268, lr_0 = 1.6420e-04
Loss = 1.2521e-01, PNorm = 36.7835, GNorm = 0.6110, lr_0 = 1.6016e-04
Loss = 6.9549e-02, PNorm = 36.8008, GNorm = 0.7057, lr_0 = 1.5622e-04
Validation auc = 0.945274
Validation accuracy = 0.957143
Epoch 24
Loss = 1.0149e-01, PNorm = 36.8112, GNorm = 0.4783, lr_0 = 1.5237e-04
Loss = 1.2047e-01, PNorm = 36.8310, GNorm = 0.4365, lr_0 = 1.4862e-04
Loss = 6.2856e-02, PNorm = 36.8451, GNorm = 0.5392, lr_0 = 1.4496e-04
Loss = 8.1795e-02, PNorm = 36.8563, GNorm = 0.9086, lr_0 = 1.4139e-04
Validation auc = 0.950802
Validation accuracy = 0.952381
Epoch 25
Loss = 9.5413e-02, PNorm = 36.8697, GNorm = 0.6784, lr_0 = 1.3791e-04
Loss = 1.0186e-01, PNorm = 36.8847, GNorm = 0.6836, lr_0 = 1.3452e-04
Loss = 7.7254e-02, PNorm = 36.8937, GNorm = 0.5201, lr_0 = 1.3121e-04
Validation auc = 0.951907
Validation accuracy = 0.952381
Epoch 26
Loss = 7.3798e-02, PNorm = 36.9077, GNorm = 0.5748, lr_0 = 1.2766e-04
Loss = 1.0510e-01, PNorm = 36.9143, GNorm = 1.1485, lr_0 = 1.2452e-04
Loss = 8.5526e-02, PNorm = 36.9339, GNorm = 1.5706, lr_0 = 1.2146e-04
Validation auc = 0.968491
Validation accuracy = 0.961905
Epoch 27
Loss = 7.6928e-02, PNorm = 36.9435, GNorm = 0.8599, lr_0 = 1.1847e-04
Loss = 8.4895e-02, PNorm = 36.9545, GNorm = 0.8606, lr_0 = 1.1555e-04
Loss = 1.1246e-01, PNorm = 36.9639, GNorm = 1.5771, lr_0 = 1.1271e-04
Loss = 6.0757e-02, PNorm = 36.9721, GNorm = 0.9799, lr_0 = 1.0993e-04
Loss = 1.1177e-01, PNorm = 36.9735, GNorm = 0.9071, lr_0 = 1.0966e-04
Validation auc = 0.965727
Validation accuracy = 0.957143
Epoch 28
Loss = 7.9740e-02, PNorm = 36.9842, GNorm = 0.7409, lr_0 = 1.0696e-04
Loss = 7.6260e-02, PNorm = 36.9930, GNorm = 0.6051, lr_0 = 1.0433e-04
Loss = 7.5695e-02, PNorm = 37.0039, GNorm = 0.3334, lr_0 = 1.0176e-04
Validation auc = 0.966280
Validation accuracy = 0.961905
Epoch 29
Loss = 8.8113e-02, PNorm = 37.0119, GNorm = 0.5521, lr_0 = 1.0000e-04
Loss = 7.6337e-02, PNorm = 37.0228, GNorm = 0.8974, lr_0 = 1.0000e-04
Loss = 7.9950e-02, PNorm = 37.0330, GNorm = 0.3464, lr_0 = 1.0000e-04
Validation auc = 0.962963
Validation accuracy = 0.957143
Model 0 best validation auc = 0.968491 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.991057
Model 0 test accuracy = 0.981043
Ensemble test auc = 0.991057
Ensemble test accuracy = 0.981043
Fold 2
Splitting data with seed 44
Class sizes
Active 0: 94.86%, 1: 5.14%
Total size = 2,101 | train size = 1,680 | val size = 210 | test size = 211
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 4.2314e-01, PNorm = 34.0188, GNorm = 0.6778, lr_0 = 2.5000e-04
Loss = 2.5874e-01, PNorm = 34.0296, GNorm = 0.5666, lr_0 = 3.8636e-04
Loss = 2.1849e-01, PNorm = 34.0371, GNorm = 0.1806, lr_0 = 5.2273e-04
Validation auc = 0.718136
Validation accuracy = 0.947619
Epoch 1
Loss = 2.2868e-01, PNorm = 34.0543, GNorm = 0.7950, lr_0 = 6.7273e-04
Loss = 1.6822e-01, PNorm = 34.0708, GNorm = 0.3634, lr_0 = 8.0909e-04
Loss = 2.1313e-01, PNorm = 34.0918, GNorm = 0.2711, lr_0 = 9.4545e-04
Validation auc = 0.503883
Validation accuracy = 0.947619
Epoch 2
Loss = 2.3974e-01, PNorm = 34.1183, GNorm = 0.2264, lr_0 = 9.8516e-04
Loss = 1.7291e-01, PNorm = 34.1609, GNorm = 0.4942, lr_0 = 9.6091e-04
Loss = 1.6653e-01, PNorm = 34.2115, GNorm = 0.2012, lr_0 = 9.3726e-04
Loss = 2.6903e-01, PNorm = 34.2332, GNorm = 0.5117, lr_0 = 9.1420e-04
Loss = 2.1641e-01, PNorm = 34.2370, GNorm = 0.3610, lr_0 = 9.1192e-04
Validation auc = 0.503426
Validation accuracy = 0.947619
Epoch 3
Loss = 1.7993e-01, PNorm = 34.2929, GNorm = 0.9627, lr_0 = 8.8948e-04
Loss = 1.9423e-01, PNorm = 34.3226, GNorm = 0.5388, lr_0 = 8.6758e-04
Loss = 1.8572e-01, PNorm = 34.3582, GNorm = 0.2164, lr_0 = 8.4623e-04
Validation auc = 0.521699
Validation accuracy = 0.947619
Epoch 4
Loss = 1.6748e-01, PNorm = 34.4105, GNorm = 0.2793, lr_0 = 8.2540e-04
Loss = 1.7143e-01, PNorm = 34.4583, GNorm = 0.3318, lr_0 = 8.0509e-04
Loss = 2.0963e-01, PNorm = 34.5150, GNorm = 0.8780, lr_0 = 7.8527e-04
Validation auc = 0.542257
Validation accuracy = 0.947619
Epoch 5
Loss = 2.2378e-01, PNorm = 34.5429, GNorm = 0.2705, lr_0 = 7.6595e-04
Loss = 1.7848e-01, PNorm = 34.6046, GNorm = 0.1762, lr_0 = 7.4710e-04
Loss = 1.7998e-01, PNorm = 34.6519, GNorm = 0.5655, lr_0 = 7.2871e-04
Loss = 1.5371e-01, PNorm = 34.7001, GNorm = 0.2814, lr_0 = 7.1077e-04
Validation auc = 0.595706
Validation accuracy = 0.947619
Epoch 6
Loss = 1.4566e-01, PNorm = 34.7524, GNorm = 0.2777, lr_0 = 6.9156e-04
Loss = 1.6205e-01, PNorm = 34.7982, GNorm = 0.2422, lr_0 = 6.7453e-04
Loss = 1.8382e-01, PNorm = 34.8396, GNorm = 0.6731, lr_0 = 6.5793e-04
Validation auc = 0.693467
Validation accuracy = 0.947619
Epoch 7
Loss = 1.5329e-01, PNorm = 34.8900, GNorm = 0.6425, lr_0 = 6.4174e-04
Loss = 1.5043e-01, PNorm = 34.9522, GNorm = 0.2971, lr_0 = 6.2595e-04
Loss = 1.7888e-01, PNorm = 34.9905, GNorm = 1.0788, lr_0 = 6.1054e-04
Validation auc = 0.679762
Validation accuracy = 0.947619
Epoch 8
Loss = 3.0756e-01, PNorm = 35.0351, GNorm = 0.5722, lr_0 = 5.9403e-04
Loss = 1.4688e-01, PNorm = 35.0814, GNorm = 0.2681, lr_0 = 5.7941e-04
Loss = 1.2815e-01, PNorm = 35.1404, GNorm = 0.2325, lr_0 = 5.6515e-04
Loss = 1.4792e-01, PNorm = 35.1950, GNorm = 0.6541, lr_0 = 5.5124e-04
Validation auc = 0.704431
Validation accuracy = 0.947619
Epoch 9
Loss = 1.0181e-01, PNorm = 35.2449, GNorm = 1.1463, lr_0 = 5.3767e-04
Loss = 1.9756e-01, PNorm = 35.2825, GNorm = 0.2800, lr_0 = 5.2444e-04
Loss = 1.2621e-01, PNorm = 35.3297, GNorm = 0.2908, lr_0 = 5.1153e-04
Validation auc = 0.743719
Validation accuracy = 0.947619
Epoch 10
Loss = 1.7288e-01, PNorm = 35.3813, GNorm = 0.2574, lr_0 = 4.9894e-04
Loss = 1.2042e-01, PNorm = 35.4379, GNorm = 0.4111, lr_0 = 4.8666e-04
Loss = 1.2191e-01, PNorm = 35.4867, GNorm = 0.9088, lr_0 = 4.7469e-04
Validation auc = 0.716766
Validation accuracy = 0.952381
Epoch 11
Loss = 6.6057e-02, PNorm = 35.5319, GNorm = 0.2680, lr_0 = 4.6185e-04
Loss = 1.3352e-01, PNorm = 35.5737, GNorm = 0.1965, lr_0 = 4.5048e-04
Loss = 1.1894e-01, PNorm = 35.6073, GNorm = 0.3502, lr_0 = 4.3940e-04
Loss = 1.5855e-01, PNorm = 35.6530, GNorm = 0.2295, lr_0 = 4.2858e-04
Validation auc = 0.728186
Validation accuracy = 0.947619
Epoch 12
Loss = 1.1554e-01, PNorm = 35.6949, GNorm = 0.6310, lr_0 = 4.1803e-04
Loss = 1.1258e-01, PNorm = 35.7320, GNorm = 0.4024, lr_0 = 4.0775e-04
Loss = 1.5163e-01, PNorm = 35.7762, GNorm = 0.8834, lr_0 = 3.9771e-04
Validation auc = 0.760164
Validation accuracy = 0.947619
Epoch 13
Loss = 1.1988e-01, PNorm = 35.8201, GNorm = 0.4912, lr_0 = 3.8696e-04
Loss = 9.0495e-02, PNorm = 35.8553, GNorm = 0.4278, lr_0 = 3.7743e-04
Loss = 1.6564e-01, PNorm = 35.8856, GNorm = 0.5748, lr_0 = 3.6814e-04
Loss = 1.1921e-01, PNorm = 35.9122, GNorm = 1.1476, lr_0 = 3.5908e-04
Validation auc = 0.757880
Validation accuracy = 0.952381
Epoch 14
Loss = 1.0832e-01, PNorm = 35.9424, GNorm = 0.6071, lr_0 = 3.5025e-04
Loss = 1.1160e-01, PNorm = 35.9819, GNorm = 0.3474, lr_0 = 3.4163e-04
Loss = 1.1313e-01, PNorm = 36.0146, GNorm = 0.3911, lr_0 = 3.3322e-04
Validation auc = 0.751485
Validation accuracy = 0.957143
Epoch 15
Loss = 1.0348e-01, PNorm = 36.0449, GNorm = 0.5615, lr_0 = 3.2502e-04
Loss = 7.1638e-02, PNorm = 36.0711, GNorm = 0.6761, lr_0 = 3.1702e-04
Loss = 1.2018e-01, PNorm = 36.0990, GNorm = 0.7546, lr_0 = 3.0921e-04
Validation auc = 0.749657
Validation accuracy = 0.928571
Epoch 16
Loss = 1.6791e-01, PNorm = 36.1262, GNorm = 0.5742, lr_0 = 3.0085e-04
Loss = 9.6780e-02, PNorm = 36.1612, GNorm = 0.6096, lr_0 = 2.9345e-04
Loss = 1.1165e-01, PNorm = 36.1858, GNorm = 0.3349, lr_0 = 2.8623e-04
Loss = 1.1130e-01, PNorm = 36.2244, GNorm = 0.4180, lr_0 = 2.7918e-04
Validation auc = 0.735496
Validation accuracy = 0.952381
Epoch 17
Loss = 1.2395e-01, PNorm = 36.2488, GNorm = 0.4403, lr_0 = 2.7231e-04
Loss = 1.1177e-01, PNorm = 36.2756, GNorm = 0.7819, lr_0 = 2.6561e-04
Loss = 8.2958e-02, PNorm = 36.2957, GNorm = 0.2425, lr_0 = 2.5907e-04
Validation auc = 0.790315
Validation accuracy = 0.947619
Epoch 18
Loss = 1.0380e-01, PNorm = 36.3205, GNorm = 0.2194, lr_0 = 2.5207e-04
Loss = 1.0115e-01, PNorm = 36.3442, GNorm = 0.2596, lr_0 = 2.4586e-04
Loss = 9.4817e-02, PNorm = 36.3690, GNorm = 0.9469, lr_0 = 2.3981e-04
Validation auc = 0.781179
Validation accuracy = 0.938095
Epoch 19
Loss = 5.0407e-02, PNorm = 36.3899, GNorm = 0.4214, lr_0 = 2.3391e-04
Loss = 1.0502e-01, PNorm = 36.4152, GNorm = 0.9728, lr_0 = 2.2815e-04
Loss = 1.0419e-01, PNorm = 36.4383, GNorm = 0.2558, lr_0 = 2.2254e-04
Loss = 8.7342e-02, PNorm = 36.4616, GNorm = 1.1575, lr_0 = 2.1706e-04
Validation auc = 0.797624
Validation accuracy = 0.957143
Epoch 20
Loss = 9.6335e-02, PNorm = 36.4784, GNorm = 0.7152, lr_0 = 2.1172e-04
Loss = 1.0093e-01, PNorm = 36.4990, GNorm = 1.0548, lr_0 = 2.0651e-04
Loss = 9.4104e-02, PNorm = 36.5182, GNorm = 0.3315, lr_0 = 2.0142e-04
Validation auc = 0.797624
Validation accuracy = 0.942857
Epoch 21
Loss = 1.0497e-01, PNorm = 36.5359, GNorm = 0.2487, lr_0 = 1.9598e-04
Loss = 8.2485e-02, PNorm = 36.5557, GNorm = 0.3081, lr_0 = 1.9115e-04
Loss = 1.0012e-01, PNorm = 36.5716, GNorm = 0.6277, lr_0 = 1.8645e-04
Validation auc = 0.780265
Validation accuracy = 0.957143
Epoch 22
Loss = 1.5388e-01, PNorm = 36.5929, GNorm = 0.5667, lr_0 = 1.8186e-04
Loss = 9.4851e-02, PNorm = 36.6059, GNorm = 1.0016, lr_0 = 1.7739e-04
Loss = 7.2811e-02, PNorm = 36.6205, GNorm = 0.8592, lr_0 = 1.7302e-04
Loss = 9.2555e-02, PNorm = 36.6322, GNorm = 0.8371, lr_0 = 1.6876e-04
Validation auc = 0.800822
Validation accuracy = 0.942857
Epoch 23
Loss = 9.1876e-02, PNorm = 36.6540, GNorm = 0.7945, lr_0 = 1.6420e-04
Loss = 8.8392e-02, PNorm = 36.6648, GNorm = 0.8662, lr_0 = 1.6016e-04
Loss = 9.4259e-02, PNorm = 36.6848, GNorm = 0.2692, lr_0 = 1.5622e-04
Validation auc = 0.787117
Validation accuracy = 0.957143
Epoch 24
Loss = 1.2787e-01, PNorm = 36.7008, GNorm = 1.1813, lr_0 = 1.5237e-04
Loss = 8.2352e-02, PNorm = 36.7131, GNorm = 1.3306, lr_0 = 1.4862e-04
Loss = 8.4245e-02, PNorm = 36.7301, GNorm = 0.8006, lr_0 = 1.4496e-04
Loss = 6.8368e-02, PNorm = 36.7412, GNorm = 0.5741, lr_0 = 1.4139e-04
Validation auc = 0.803563
Validation accuracy = 0.952381
Epoch 25
Loss = 8.1527e-02, PNorm = 36.7539, GNorm = 1.7026, lr_0 = 1.3791e-04
Loss = 9.2895e-02, PNorm = 36.7690, GNorm = 0.4742, lr_0 = 1.3452e-04
Loss = 6.9718e-02, PNorm = 36.7809, GNorm = 0.4404, lr_0 = 1.3121e-04
Validation auc = 0.798538
Validation accuracy = 0.957143
Epoch 26
Loss = 6.3002e-02, PNorm = 36.7935, GNorm = 0.1960, lr_0 = 1.2766e-04
Loss = 8.2509e-02, PNorm = 36.8030, GNorm = 0.3264, lr_0 = 1.2452e-04
Loss = 7.9525e-02, PNorm = 36.8151, GNorm = 0.3529, lr_0 = 1.2146e-04
Validation auc = 0.806761
Validation accuracy = 0.942857
Epoch 27
Loss = 4.4590e-02, PNorm = 36.8266, GNorm = 0.5673, lr_0 = 1.1847e-04
Loss = 9.7644e-02, PNorm = 36.8384, GNorm = 0.2327, lr_0 = 1.1555e-04
Loss = 6.9026e-02, PNorm = 36.8523, GNorm = 0.8651, lr_0 = 1.1271e-04
Loss = 7.4374e-02, PNorm = 36.8625, GNorm = 0.4025, lr_0 = 1.0993e-04
Loss = 1.5894e-01, PNorm = 36.8635, GNorm = 0.6294, lr_0 = 1.0966e-04
Validation auc = 0.819095
Validation accuracy = 0.952381
Epoch 28
Loss = 8.9467e-02, PNorm = 36.8696, GNorm = 0.8702, lr_0 = 1.0696e-04
Loss = 6.8899e-02, PNorm = 36.8805, GNorm = 0.6219, lr_0 = 1.0433e-04
Loss = 8.5503e-02, PNorm = 36.8881, GNorm = 0.2956, lr_0 = 1.0176e-04
Validation auc = 0.802650
Validation accuracy = 0.947619
Epoch 29
Loss = 4.3130e-02, PNorm = 36.9001, GNorm = 0.6990, lr_0 = 1.0000e-04
Loss = 6.7489e-02, PNorm = 36.9093, GNorm = 0.6427, lr_0 = 1.0000e-04
Loss = 7.9788e-02, PNorm = 36.9182, GNorm = 0.7334, lr_0 = 1.0000e-04
Validation auc = 0.810416
Validation accuracy = 0.947619
Model 0 best validation auc = 0.819095 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.853659
Model 0 test accuracy = 0.976303
Ensemble test auc = 0.853659
Ensemble test accuracy = 0.976303
3-fold cross validation
	Seed 42 ==> test auc = 0.978448
	Seed 42 ==> test accuracy = 0.976303
	Seed 43 ==> test auc = 0.991057
	Seed 43 ==> test accuracy = 0.981043
	Seed 44 ==> test auc = 0.853659
	Seed 44 ==> test accuracy = 0.976303
Overall test auc = 0.941055 +/- 0.062012
Overall test accuracy = 0.977883 +/- 0.002234
Elapsed time = 0:13:50
